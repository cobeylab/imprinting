Readme

This repository contains files that can be used to reconstruct imprinting patterns.
Current data allows reoncstrucitons up to 2017.



WORKFLOW for adding new countries:
----------------------------------
1. Go to http://apps.who.int/flumart/Default?ReportNo=12
2. Display report for the country(ies) of interest starting at week 1 of the earliest possible year and continuing to the final week of the current year
3. Click on the disk icon at the top middle of the page to save the output as a .csv. The file will automatically save to Downloads.
4. Move the file to ~/Dropbox/R/Reconstructions under the filname COUNTRY_cocirculation.csv
5. Open Reformat_WHO_to_master.R
6. Import the new file from step 4 into the script and run the script to reformat. The script will save a reformatted file under "Reformatted_output.csv"
7. Copy the reformatted output into CocirculationData.csv and save
8. Repeat 1-7 for all countries of interest
9 Add the countries of interest at line 39 of Infection_age_structure_2017.R and verify that the script works



Classes of .csv files:
-----------------------
.*cocirculation.csv contains raw data dowlonaded from WHO Flu Net for the countrie(s) and years of interest

.*summary.csv contains a reformatted version of the raw data in .*cocirculation.csv. At one point, I was creating these reformatted files and then copying the relevant parts into a master .csv file.

CocirculationData.csv is the master file that contains a summary of all virological data from all countries and all years up to 2017. This file is read by Clean_CocirculationImport_2017.R



Notes on .R files:
-------------------
Clean_CocirculationImport_2017.R    Imports virological surveillance data from CocirculationData.csv and adds this data to a standard cocirculation template. Sources functions that generate country-specific tables of H1N1, H2N2 and H3N2 dominance in a certain year.
- Pre-1977 we assume only one subtype circulated each year.
- From 1977-~1997 we use summary data from the United States
- From 1997 on, we download country-specific data when possible, or substitute summary data from the surrounding region.

gete_ij_2017.R    Defines a function that estimates the probabiltiy of first exposure in year x, x+1, x+2, ... x+12 given birth in year x.

get.country.cocirculation.data_2017.R

Infection_age_structure_2017.R

Reformat_WHO_to_master.R    Loads a .csv using the raw WHO format (eg .*cocirculation.csv), and reformats the data to match the format of CocirculationData.csv
