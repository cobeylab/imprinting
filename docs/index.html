<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Reconstruct birth-year specific probabilities of immune imprinting to influenza A, using the methods of Gostic et al. (2016) &lt;doi:10.1126/science.aag1322&gt;. Plot, save, or export the calculated probabilities for use in your own research. By default, the package calculates subtype-specific imprinting probabilities, but with user-provided frequency data, it is possible to calculate probabilities for arbitrary kinds of primary exposure to influenza A, including primary vaccination and exposure to specific clades, strains, etc.">
<title>Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza • imprinting</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza">
<meta property="og:description" content="Reconstruct birth-year specific probabilities of immune imprinting to influenza A, using the methods of Gostic et al. (2016) &lt;doi:10.1126/science.aag1322&gt;. Plot, save, or export the calculated probabilities for use in your own research. By default, the package calculates subtype-specific imprinting probabilities, but with user-provided frequency data, it is possible to calculate probabilities for arbitrary kinds of primary exposure to influenza A, including primary vaccination and exposure to specific clades, strains, etc.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">imprinting</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/custom-imprinting-types.html">custom-imprinting-types</a>
    <a class="dropdown-item" href="articles/intro-to-imprinting.html">intro-to-imprinting</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cobeylab/imprinting/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="imprinting">imprinting<a class="anchor" aria-label="anchor" href="#imprinting"></a>
</h1></div>
</div>
<div class="section level1">
<h1 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h1>
<p>imprinting is an R package to reconstruct birth year-specific probabilities of imprinting to influenza A. Reconstructions are done following the methods of <a href="https://doi.org/10.1126/science.aag1322" class="external-link">Gostic et al. (2016)</a>.</p>
<p>By default the package calculates subtype-specific probabilities of imprinting to H1N1, H2N2, and H3N2, but it is possible to calculate other kinds of imprinting probabilities (e.g. clade-level, strain-level, vaccination) using user-provided circulation frequencies. We may consider including influenza B-specific probabilities in future updates if there is demand. Please submit an <a href="https://github.com/cobeylab/imprinting/issues" class="external-link">issue</a> to let us know if you need influenza B-specific functionality.</p>
<ul>
<li>
<code><a href="reference/get_imprinting_probabilities.html">get_imprinting_probabilities()</a></code> returns a data frame containing birth year-specific probabilities of imprinting to H1N1, H2N2, or H3N2 for an individual in each input country and year of observation.</li>
<li>
<code><a href="reference/show_available_countries.html">show_available_countries()</a></code> lists the available countries (those with data in <a href="https://apps.who.int/flumart/Default?ReportNo=12" class="external-link">WHO Flu Mart</a>), with valid spellings.</li>
<li>
<code><a href="reference/plot_one_country_year.html">plot_one_country_year()</a></code> and <code><a href="reference/plot_many_country_years.html">plot_many_country_years()</a></code> generates plots using the outputs of <code>get_imprinting_probabilites()</code>.</li>
</ul>
<p>The generated probabilities may be modified, plotted, and used in independent research. Please cite <a href="https://doi.org/10.1126/science.aag1322" class="external-link">Gostic et al. (2016)</a>, and this package (<code>citation("imprinting")</code>).</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>imprinting is not yet available on CRAN, but the development version can be installed from github, using the devtools package:</p>
<pre><code><span><span class="co"># Install devtools</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="co"># Use devtools to install impritning from github</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"cobeylab/imprinting"</span><span class="op">)</span> </span></code></pre>
</div>
<div class="section level1">
<h1 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cobeylab.github.io/imprinting/">imprinting</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Get imprinting probabilities</span></span>
<span><span class="va">probs</span> <span class="op">=</span> <span class="fu"><a href="reference/get_imprinting_probabilities.html">get_imprinting_probabilities</a></span><span class="op">(</span>observation_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2022</span><span class="op">)</span>,</span>
<span>                             countries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'United States'</span>, <span class="st">'Brazil'</span>, <span class="st">'Vietnam'</span>, <span class="st">'Indonesia'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">probs</span></span>
<span><span class="co">#&gt; # A tibble: 3,360 × 5</span></span>
<span><span class="co">#&gt;    year country       birth_year subtype imprinting_prob</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  2000 United States       2022 A/H1N1        0.297    </span></span>
<span><span class="co">#&gt; 2  2022 United States       2022 A/H1N1        0.0000297</span></span>
<span><span class="co">#&gt; 3  2000 Brazil              2022 A/H1N1        0.331    </span></span>
<span><span class="co">#&gt; 4  2022 Brazil              2022 A/H1N1        0        </span></span>
<span><span class="co">#&gt; 5  2000 Vietnam             2022 A/H1N1        0.267    </span></span>
<span><span class="co">#&gt; # … with 3,355 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot imprinting probabilities </span></span>
<span><span class="co">##  - up to five countries</span></span>
<span><span class="co">##  - show aging of birth cohorts from first to last observation year</span></span>
<span><span class="fu"><a href="reference/plot_many_country_years.html">plot_many_country_years</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-3-1.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" width="100%"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot imprinting probabilities</span></span>
<span><span class="co">##  - select the first country year in the probs tibble by default</span></span>
<span><span class="fu"><a href="reference/plot_one_country_year.html">plot_one_country_year</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-4-1.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" width="100%"></p>
</div>
<div class="section level1">
<h1 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h1>
<p>There are two main kinds of data used to reconstruct birth year-specific imprinting probailities. Because there is no single epidemiological data source that documents the entire circulation history of influenza from 1918-present, we pull from various sources.</p>
<div class="section level2">
<h2 id="id_1-cocirculation-data">1. Cocirculation data<a class="anchor" aria-label="anchor" href="#id_1-cocirculation-data"></a>
</h2>
<p>Cocirculation data describes the relative dominance of each influenza A subtype (H1N1, H2N2, H3N2) in circulation each year. It is informed by the following data:</p>
<ul>
<li>
<p><strong>1918-1976</strong> Based on the available historical data, we assume only one subtype circulated each year:</p>
<ul>
<li>1918-1956: H1N1</li>
<li>1957-1967: H2N2</li>
<li>1968-1976: H3N2</li>
</ul>
</li>
<li><p><strong>1977-1996</strong> Two subtypes, H1N1 and H3N2, co-circulated globally, but country-specific influenza surveillance data are not publicly available for this time period. We use data on the number of influenza specimens that tested positive for each influenza subtype in US surveillance (Table 1 of <a href="https://jamanetwork.com/journals/jama/fullarticle/195750" class="external-link">Thompson et al. JAMA, 2003</a>) to calculate the fraction of circulation caused by each subtype.</p></li>
<li><p><strong>1996-present</strong> Two subtypes, H1N1 and H3N2, continue to co-circulate globally. We pull country-specific data from WHO Flu Mart() to estimate the fraction of specimens that tested positive for subtype H1N1 or H3N2. If a country reported fewer than <code>min_samples</code> (default 30) influenza A-positive specimens in a given year, we substitute data from the country’s WHO Region to ensure a sufficient sample size.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="id_2-intensity-data">2. Intensity data<a class="anchor" aria-label="anchor" href="#id_2-intensity-data"></a>
</h2>
<p>Children are more likely to imprint in years with high levels of influenza A circulation. We define an annual intensity score to characterize annual circulation intensity, and to scale the annual probability of primary infection. By definition, a circulation intensity of 1 indicates average levels of influenza ciruclation. We use three kinds of data to characterize annual circulation intensity:</p>
<ul>
<li><p><strong>For 1918-1996</strong>, we calculate annual intensity using the methods of <a href="https://doi.org/10.1126/science.aag1322" class="external-link">Gostic et al. (2016)</a>. From 1918-1976, intensity scores are informed by Pneumonia and Influenza excess mortaltity estimates <a href="https://academic.oup.com/aje/article-abstract/100/1/40/226436" class="external-link">Housworth et al. 1974</a>, and from 1976-1977, intensity scores are informed by the influenza A test-positive fraction reported in Table 1 of <a href="https://jamanetwork.com/journals/jama/fullarticle/195750" class="external-link">Thompson et al. JAMA, 2003</a>.</p></li>
<li><p>For <strong>1997-present</strong>, we calculate country or region-specific intensities using surveillance data from WHO Flu Mart. Intensity is calculated as: [fraction of processed samples positive for flu A]/[mean fraction of processed samples positive for flu A]. Country-specific data are used by default. Regional data are substituted when there are an insufficient number of country-specific specimens.</p></li>
</ul>
</div>
</div>
<div class="section level1">
<h1 id="funding">Funding<a class="anchor" aria-label="anchor" href="#funding"></a>
</h1>
<p>Development of this R package was supported by the <a href="https://www.ceirr-network.org/" class="external-link">NIH Centers of Excellence in Influenza Research and Response</a> (CEIRR) Network of the National Institutes of Health under contract number 75N93021C00015. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.</p>
</div>
<div class="section level1">
<h1 id="bugs">Bugs<a class="anchor" aria-label="anchor" href="#bugs"></a>
</h1>
<p>To report bugs, please file an issue with a reproducible example at <a href="https://github.com/cobeylab/imprinting" class="external-link">github.com/cobeylab/imprinting</a>.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/cobeylab/imprinting/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/cobeylab/imprinting/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing imprinting</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Katelyn Gostic <br><small class="roles"> Author </small>  </li>
<li>Alex Byrnes <br><small class="roles"> Contributor, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Katelyn Gostic, Alex Byrnes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
