<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="imprinting">
<title>intro-to-imprinting • imprinting</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="intro-to-imprinting">
<meta property="og:description" content="imprinting">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">imprinting</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro-to-imprinting.html">intro-to-imprinting</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>intro-to-imprinting</h1>
            
      
      
      <div class="d-none name"><code>intro-to-imprinting.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="install-the-imprinting-package">1. Install the imprinting package<a class="anchor" aria-label="anchor" href="#install-the-imprinting-package"></a>
</h2>
<p>The <code>imprinting</code> package isn’t yet available on <a href="https://cran.r-project.org/" class="external-link">CRAN</a>, so it can’t yet be installed using the normal <code>install.packages("imprinting")</code> command in R. (But this feature is coming soon!)</p>
<p>For now, we have to install the package from github using the following steps.</p>
<div class="section level4">
<h4 id="install-the-devtools-package">1.1 Install the devtools package<a class="anchor" aria-label="anchor" href="#install-the-devtools-package"></a>
</h4>
<p>If prompted: you do not need to researt R prior to lading, and you do not need to install from souce.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span>, repos<span class="op">=</span><span class="st">'http://cran.us.r-project.org'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="load-the-devtools-package">1.2 Load the devtools package<a class="anchor" aria-label="anchor" href="#load-the-devtools-package"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span> <span class="co"># Load the package</span></span>
<span><span class="co">#&gt; Loading required package: usethis</span></span></code></pre></div>
<p>Now that we have devtools installed, we can use the <code><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github()</a></code> function to install the imprinting package.</p>
</div>
<div class="section level4">
<h4 id="install-the-imprinting-package-from-github">1.3 Install the imprinting package from github<a class="anchor" aria-label="anchor" href="#install-the-imprinting-package-from-github"></a>
</h4>
<p>This builds and installs the package using source files from <a href="github.com/cobeylab/imprinting">github.com/cobeylab/imprinting</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"cobeylab/imprinting"</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="load-the-imprinting-package">1.4 Load the imprinting package<a class="anchor" aria-label="anchor" href="#load-the-imprinting-package"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cobeylab.github.io/imprinting/">imprinting</a></span><span class="op">)</span> </span></code></pre></div>
<p>Now the package should be installed and loaded into your R workspace.</p>
</div>
</div>
<div class="section level2">
<h2 id="use-the-package-to-calculate-imprinting-probabilities">2. Use the package to calculate imprinting probabilities<a class="anchor" aria-label="anchor" href="#use-the-package-to-calculate-imprinting-probabilities"></a>
</h2>
<p>The main reason to use the <code>imprinting</code> package is to calculate birth year-specific probabilities of imprinting to a specific subtype of influenza A. You can read more about the biology and methods behind these calculations in <a href="https://www.science.org/doi/10.1126/science.aag1322" class="external-link">Gostic et al. 2016</a>.</p>
<div class="section level3">
<h3 id="calculate-imprinting-probabilities-for-one-country-and-year-of-observation">2.1 Calculate imprinting probabilities for one country and year of observation<a class="anchor" aria-label="anchor" href="#calculate-imprinting-probabilities-for-one-country-and-year-of-observation"></a>
</h3>
<p>Use the function <code><a href="../reference/get_imprinting_probabilities.html">get_imprinting_probabilities()</a></code>. Run <code><a href="../reference/get_imprinting_probabilities.html">?get_imprinting_probabilities</a></code> for help.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_imprinting_probabilities.html">get_imprinting_probabilities</a></span><span class="op">(</span>observation_years <span class="op">=</span> <span class="fl">2022</span>, countries <span class="op">=</span> <span class="st">"United States"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 420 × 5</span></span></span>
<span><span class="co">#&gt;    subtype  year country       birth_year imprinting_prob</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> H1N1     <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>022       0.000<span style="text-decoration: underline;">029</span>7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> H1N1     <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>021       0.000<span style="text-decoration: underline;">067</span>9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> H1N1     <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>020       0.070<span style="text-decoration: underline;">2</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> H1N1     <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>019       0.152    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> H1N1     <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>018       0.171    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> H1N1     <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>017       0.147    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> H1N1     <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>016       0.225    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> H1N1     <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>015       0.169    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> H1N1     <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>014       0.308    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> H1N1     <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>013       0.321    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 410 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows</span></span></span></code></pre></div>
<p>The function returns a tibble wtih five columns: <code>subtype</code>, <code>year</code>, <code>country</code>, <code>birth_year</code>, and <code>imprinting_prob</code>. The column <code>imprinting_prob</code> gives the probability that someone born in <code>birth_year</code> and observed in <code>year</code> has imprinted to <code>subtype</code>.</p>
<p>We can run the same command use the <code>df_format='wide'</code> option to output the same results in wide format. This displays all imprinting probabilities for the cohort side-by-side</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_imprinting_probabilities.html">get_imprinting_probabilities</a></span><span class="op">(</span>observation_years <span class="op">=</span> <span class="fl">2022</span>, </span>
<span>                             countries <span class="op">=</span> <span class="st">"United States"</span>, </span>
<span>                             df_format <span class="op">=</span> <span class="st">'wide'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 105 × 7</span></span></span>
<span><span class="co">#&gt;     year country       birth_year      H1N1  H2N2   H3N2  naive</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>022 0.000<span style="text-decoration: underline;">029</span>7     0 0.031<span style="text-decoration: underline;">6</span> 0.968 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>021 0.000<span style="text-decoration: underline;">067</span>9     0 0.044<span style="text-decoration: underline;">5</span> 0.955 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>020 0.070<span style="text-decoration: underline;">2</span>        0 0.044<span style="text-decoration: underline;">5</span> 0.885 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>019 0.152         0 0.112  0.736 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>018 0.171         0 0.192  0.636 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>017 0.147         0 0.342  0.512 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>016 0.225         0 0.347  0.428 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>015 0.169         0 0.518  0.313 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>014 0.308         0 0.548  0.143 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>013 0.321         0 0.612  0.067<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 95 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="why-do-we-specify-the-observation_year">2.2 Why do we specify the <code>observation_year</code>?<a class="anchor" aria-label="anchor" href="#why-do-we-specify-the-observation_year"></a>
</h3>
<p>The <code>observation_year</code> affects imprinting probabilities in birth cohorts who are young enough to still be in the process of imprinting. Our model assumes that everyone has been infected by influenza before age 12, so in cohorts &lt;12 years of age at the time of observation, imprinting probabilities depend on the observation year.</p>
<p>E.g. consider the cohort born in 2000:</p>
<ul>
<li>If the observation year is 2005, then this birth cohort is five years old, and still young enough to remain naive to influenza. The outputs below show that 22.9% of the cohort has not yet imprinted to any subtype.</li>
<li>If we calculate imprinting probabilities for the same birth cohort observed in 2011 (at age 11), the model shows that most of the cohort has imprinted, but there is still a very small non-zero probability of remaining naive.</li>
<li>When the cohort reaches age 12, (observation year 2012) the model enforces the assumption that everyone in the cohort has imprinted. It normalizes the probabilities of subtype-specific imprinting so that the H1N1, H2N2, and H3N2-specific probabilities sum to 1, and it sets the naive probability to zero.</li>
<li>Once the cohort reaches age 12, imprinting probabilities are fixed. The outputs below show that imprinting probabilities for the 2000 cohort are identical if observed at age 12 (in 2012), or at age 22 (in 2022).</li>
</ul>
<p>Note: we added the age_at_observation column to the outputs below for clarity.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_imprinting_probabilities.html">get_imprinting_probabilities</a></span><span class="op">(</span>observation_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2005</span>, <span class="fl">2011</span>, <span class="fl">2012</span>, <span class="fl">2022</span><span class="op">)</span>, </span>
<span>                             countries <span class="op">=</span> <span class="st">"United States"</span>, </span>
<span>                             df_format <span class="op">=</span> <span class="st">'wide'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">birth_year</span> <span class="op">==</span> <span class="fl">2000</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>age_at_observation <span class="op">=</span> <span class="va">year</span><span class="op">-</span><span class="va">birth_year</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">8</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 8</span></span></span>
<span><span class="co">#&gt;    year country       birth_year age_at_observation  H1N1  H2N2  H3N2  naive</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>005 United States       <span style="text-decoration: underline;">2</span>000                  5 0.196     0 0.574 0.229 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>011 United States       <span style="text-decoration: underline;">2</span>000                 11 0.322     0 0.667 0.010<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>012 United States       <span style="text-decoration: underline;">2</span>000                 12 0.324     0 0.676 0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">2</span>000                 22 0.324     0 0.676 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="view-a-list-of-the-available-countries">2.2 View a list of the available countries<a class="anchor" aria-label="anchor" href="#view-a-list-of-the-available-countries"></a>
</h3>
<p>We can only calculate imprinting probabilities for countries with data in <a href="https://www.who.int/tools/flunet" class="external-link">WHO Flu Net</a>. The input name and spelling must match the outputs below:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_available_countries.html">show_available_countries</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 175 × 1</span></span></span>
<span><span class="co">#&gt;     country                         </span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">  1</span> Afghanistan                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">  2</span> Albania                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">  3</span> Algeria                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">  4</span> Angola                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">  5</span> Anguilla                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">  6</span> Antigua and Barbuda             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">  7</span> Argentina                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">  8</span> Armenia                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">  9</span> Aruba                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 10</span> Australia                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 11</span> Austria                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 12</span> Azerbaijan                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 13</span> Bahamas                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 14</span> Bahrain                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 15</span> Bangladesh                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 16</span> Barbados                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 17</span> Belarus                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 18</span> Belgium                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 19</span> Belize                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 20</span> Bermuda                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 21</span> Bhutan                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 22</span> Bolivia                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 23</span> Bosnia and Herzegovina          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 24</span> Brazil                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 25</span> British Virgin Islands          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 26</span> Bulgaria                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 27</span> Burkina Faso                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 28</span> Cabo Verde                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 29</span> Cambodia                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 30</span> Cameroon                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 31</span> Canada                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 32</span> Cayman Islands                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 33</span> Central African Republic        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 34</span> Chad                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 35</span> Chile                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 36</span> China                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 37</span> Colombia                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 38</span> Congo                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 39</span> Costa Rica                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 40</span> Cote d'Ivoire                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 41</span> Croatia                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 42</span> Cuba                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 43</span> Cyprus                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 44</span> Czechia                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 45</span> Democratic Republic of Congo    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 46</span> Denmark                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 47</span> Dominica                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 48</span> Dominican Republic              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 49</span> Ecuador                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 50</span> Egypt                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 51</span> El Salvador                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 52</span> Estonia                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 53</span> Ethiopia                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 54</span> Fiji                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 55</span> Finland                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 56</span> France                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 57</span> French Guiana                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 58</span> Gambia                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 59</span> Georgia                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 60</span> Germany                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 61</span> Ghana                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 62</span> Greece                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 63</span> Grenada                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 64</span> Guadeloupe                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 65</span> Guatemala                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 66</span> Guinea                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 67</span> Guinea-Bissau                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 68</span> Guyana                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 69</span> Haiti                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 70</span> Honduras                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 71</span> Hungary                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 72</span> Iceland                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 73</span> India                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 74</span> Indonesia                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 75</span> Iran                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 76</span> Iraq                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 77</span> Ireland                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 78</span> Israel                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 79</span> Italy                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 80</span> Jamaica                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 81</span> Japan                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 82</span> Jordan                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 83</span> Kazakhstan                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 84</span> Kenya                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 85</span> Kosovo                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 86</span> Kuwait                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 87</span> Kyrgyzstan                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 88</span> Laos                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 89</span> Latvia                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 90</span> Lebanon                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 91</span> Lithuania                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 92</span> Luxembourg                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 93</span> Madagascar                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 94</span> Malaysia                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 95</span> Maldives                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 96</span> Mali                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 97</span> Malta                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 98</span> Martinique                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 99</span> Mauritania                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">100</span> Mauritius                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">101</span> Mexico                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">102</span> Moldova                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">103</span> Mongolia                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">104</span> Montenegro                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">105</span> Morocco                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">106</span> Mozambique                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">107</span> Myanmar                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">108</span> Namibia                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">109</span> Nepal                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">110</span> Netherlands                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">111</span> New Caledonia                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">112</span> New Zealand                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">113</span> Nicaragua                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">114</span> Niger                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">115</span> Nigeria                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">116</span> North Korea                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">117</span> North Macedonia                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">118</span> Norway                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">119</span> Oman                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">120</span> Pakistan                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">121</span> Palestine                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">122</span> Panama                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">123</span> Papua New Guinea                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">124</span> Paraguay                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">125</span> Peru                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">126</span> Philippines                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">127</span> Poland                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">128</span> Portugal                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">129</span> Qatar                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">130</span> Romania                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">131</span> Russia                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">132</span> Rwanda                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">133</span> Saint Kitts and Nevis           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">134</span> Saint Lucia                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">135</span> Saint Vincent and the Grenadines</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">136</span> Saudi Arabia                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">137</span> Senegal                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">138</span> Serbia                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">139</span> Seychelles                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">140</span> Sierra Leone                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">141</span> Singapore                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">142</span> Slovakia                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">143</span> Slovenia                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">144</span> South Africa                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">145</span> South Korea                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">146</span> South Sudan                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">147</span> Spain                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">148</span> Sri Lanka                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">149</span> Sudan                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">150</span> Suriname                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">151</span> Sweden                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">152</span> Switzerland                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">153</span> Syria                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">154</span> Tajikistan                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">155</span> Tanzania                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">156</span> Thailand                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">157</span> Timor                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">158</span> Togo                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">159</span> Trinidad and Tobago             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">160</span> Tunisia                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">161</span> Turkey                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">162</span> Turkmenistan                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">163</span> Turks and Caicos                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">164</span> Uganda                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">165</span> Ukraine                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">166</span> United Arab Emirates            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">167</span> United Kingdom                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">168</span> United States                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">169</span> Uruguay                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">170</span> Uzbekistan                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">171</span> Venezuela                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">172</span> Vietnam                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">173</span> Yemen                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">174</span> Zambia                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">175</span> Zimbabwe</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-probabilities-for-many-countries-and-observation-years">2.3 Generate probabilities for many countries and observation years<a class="anchor" aria-label="anchor" href="#generate-probabilities-for-many-countries-and-observation-years"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">many_probabilities</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_imprinting_probabilities.html">get_imprinting_probabilities</a></span><span class="op">(</span>observation_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2019</span>, <span class="fl">2022</span><span class="op">)</span>,</span>
<span>                                                  countries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Brazil'</span>, <span class="st">'Afghanistan'</span>, <span class="st">'Estonia'</span>, <span class="st">'Finland'</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">## Store the outputs in a variable called many_probabilities</span></span>
<span><span class="va">many_probabilities</span> <span class="co">## View the outputs in the console</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,040 × 5</span></span></span>
<span><span class="co">#&gt;    subtype  year country birth_year imprinting_prob</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>022               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>021               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>020               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>019               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>018               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>017               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>016               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>015               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>014               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>013               0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 5,030 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows</span></span></span></code></pre></div>
<p>Alternatively, you can view the outputs in a separate window or save them as a .csv file on your hard drive.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View the outputs in a separate window.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">many_probabilities</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Save the outputs as a .csv file in your current working directory.</span></span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">many_probabilities</span>, <span class="st">'many_probabilities.csv'</span><span class="op">)</span> </span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="plot-the-outputs">3. Plot the outputs<a class="anchor" aria-label="anchor" href="#plot-the-outputs"></a>
</h2>
<div class="section level3">
<h3 id="plot-the-first-country-year-combination-in-the-output-data-frame">3.1 Plot the first country-year combination in the output data frame<a class="anchor" aria-label="anchor" href="#plot-the-first-country-year-combination-in-the-output-data-frame"></a>
</h3>
<p><code><a href="../reference/plot_one_country_year.html">plot_one_country_year()</a></code> takes a long-formatted output data frame and plots the first country and year combination.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">many_probabilities</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   subtype  year country birth_year imprinting_prob</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>022               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>021               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>020               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>019               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>018               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> H1N1     <span style="text-decoration: underline;">2</span>000 Brazil        <span style="text-decoration: underline;">2</span>017               0</span></span>
<span><span class="fu"><a href="../reference/plot_one_country_year.html">plot_one_country_year</a></span><span class="op">(</span><span class="va">many_probabilities</span><span class="op">)</span> </span></code></pre></div>
<p><img src="intro-to-imprinting_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="select-a-specific-country-and-year-to-plot">Select a specific country and year to plot<a class="anchor" aria-label="anchor" href="#select-a-specific-country-and-year-to-plot"></a>
</h3>
<p>You can use <code><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter()</a></code> to select a specific country and year for plotting.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_one_country_year.html">plot_one_country_year</a></span><span class="op">(</span><span class="va">many_probabilities</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">'Estonia'</span>, <span class="va">year</span> <span class="op">==</span> <span class="fl">2019</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-imprinting_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="plot-up-to-five-countires-at-a-time">3.2 Plot up to five countires at a time<a class="anchor" aria-label="anchor" href="#plot-up-to-five-countires-at-a-time"></a>
</h3>
<p><code><a href="../reference/plot_many_country_years.html">plot_many_country_years()</a></code> generates a plot of the first five countries in the imprinting outputs, across an arbitrary number of years.</p>
<ul>
<li>The plots on the left show imprinting probabilities for the latest observation year</li>
<li>The plots on the right show how H3N2 imprinting probabilities have changed as cohorts grow older from the earliest to the latest observation year in the outputs. The vertical lines and arrow show aging of the 1968 birth cohort.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_many_country_years.html">plot_many_country_years</a></span><span class="op">(</span><span class="va">many_probabilities</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-imprinting_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="explore-the-underlying-data-and-components-of-the-imprinting-probabilities">4. Explore the underlying data and components of the imprinting probabilities<a class="anchor" aria-label="anchor" href="#explore-the-underlying-data-and-components-of-the-imprinting-probabilities"></a>
</h2>
<p>Get the fraction of influenza circulation caused by each subtype in each epidemic year from 1918-2022 in the United States using <code>get_country_cocirculation</code>. Run <code><a href="../reference/get_country_cocirculation_data.html">?get_country_cocirculation_data</a></code> for notes on data sources.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_country_cocirculation_data.html">get_country_cocirculation_data</a></span><span class="op">(</span><span class="st">'United States'</span>, <span class="fl">2022</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 108 × 9</span></span></span>
<span><span class="co">#&gt;     year `A/H1N1` `A/H2N2` `A/H3N2`     A B     group1 group2 data_from         </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">1</span>918        1        0        0     1 <span style="color: #BB0000;">NA</span>         1      0 Historical_assump…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">1</span>919        1        0        0     1 <span style="color: #BB0000;">NA</span>         1      0 Historical_assump…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">1</span>920        1        0        0     1 <span style="color: #BB0000;">NA</span>         1      0 Historical_assump…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">1</span>921        1        0        0     1 <span style="color: #BB0000;">NA</span>         1      0 Historical_assump…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">1</span>922        1        0        0     1 <span style="color: #BB0000;">NA</span>         1      0 Historical_assump…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">1</span>923        1        0        0     1 <span style="color: #BB0000;">NA</span>         1      0 Historical_assump…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">1</span>924        1        0        0     1 <span style="color: #BB0000;">NA</span>         1      0 Historical_assump…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">1</span>925        1        0        0     1 <span style="color: #BB0000;">NA</span>         1      0 Historical_assump…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>926        1        0        0     1 <span style="color: #BB0000;">NA</span>         1      0 Historical_assump…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">1</span>927        1        0        0     1 <span style="color: #BB0000;">NA</span>         1      0 Historical_assump…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 98 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows</span></span></span></code></pre></div>
<p>Get the circulation intensity of influenza A in each epidemic year using <code><a href="../reference/get_country_intensity_data.html">get_country_intensity_data()</a></code>.</p>
<ul>
<li>Intensity of 1 is average. Higher values indicate more influenza A circulation, lower values indicate less circulation.</li>
</ul>
<p>See <code><a href="../reference/get_country_intensity_data.html">?get_country_intensity_data</a></code> for details on underlying data.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_country_intensity_data.html">get_country_intensity_data</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">'China'</span>, max_year <span class="op">=</span> <span class="fl">2022</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 113 × 2</span></span></span>
<span><span class="co">#&gt;     year intensity</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">1</span>911      1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">1</span>912      1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">1</span>913      1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">1</span>914      1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">1</span>915      1.12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">1</span>916      1.29</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">1</span>917      1.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">1</span>918      2.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>919      2.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">1</span>920      1.87</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 103 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="get-the-probability-that-an-individual-imprinted-0-1-2-12-years-after-birth">Get the probability that an individual imprinted 0, 1, 2, … 12 years after birth<a class="anchor" aria-label="anchor" href="#get-the-probability-that-an-individual-imprinted-0-1-2-12-years-after-birth"></a>
</h3>
<p>Use the function <code><a href="../reference/get_p_infection_year.html">get_p_infection_year()</a></code></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probs</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_p_infection_year.html">get_p_infection_year</a></span><span class="op">(</span>birth_year <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                     observation_year <span class="op">=</span> <span class="fl">2022</span>,</span>
<span>                     intensity_df <span class="op">=</span> <span class="fu"><a href="../reference/get_country_intensity_data.html">get_country_intensity_data</a></span><span class="op">(</span><span class="st">'Mexico'</span>, <span class="fl">2022</span><span class="op">)</span>,</span>
<span>                     max_year <span class="op">=</span> <span class="fl">2022</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">+</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">probs</span></span>
<span><span class="co">#&gt;        2000        2001        2002        2003        2004        2005 </span></span>
<span><span class="co">#&gt; 0.014797424 0.038348694 0.014337222 0.078764203 0.015525076 0.093914147 </span></span>
<span><span class="co">#&gt;        2006        2007        2008        2009        2010        2011 </span></span>
<span><span class="co">#&gt; 0.007673805 0.058215925 0.017624843 0.462559063 0.119102374 0.013750798 </span></span>
<span><span class="co">#&gt;        2012 </span></span>
<span><span class="co">#&gt; 0.036377222</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span> <span class="co">## Raw probabilities are not yet normalized.</span></span>
<span><span class="co">#&gt; [1] 0.9709908</span></span>
<span></span>
<span><span class="va">norm_probs</span> <span class="op">=</span> <span class="va">probs</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span> <span class="co">## Normalize</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">norm_probs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Katelyn M. Gostic.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
