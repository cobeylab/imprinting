<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="imprinting">
<title>custom-imprinting-types • imprinting</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="custom-imprinting-types">
<meta property="og:description" content="imprinting">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">imprinting</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/custom-imprinting-types.html">custom-imprinting-types</a>
    <a class="dropdown-item" href="../articles/intro-to-imprinting.html">intro-to-imprinting</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cobeylab/imprinting/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>custom-imprinting-types</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cobeylab/imprinting/blob/HEAD/vignettes/custom-imprinting-types.Rmd" class="external-link"><code>vignettes/custom-imprinting-types.Rmd</code></a></small>
      <div class="d-none name"><code>custom-imprinting-types.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="generate-probabilities-of-imprinting-to-custom-subsets-of-influenza-a-viruses">Generate probabilities of imprinting to custom subsets of influenza
A viruses<a class="anchor" aria-label="anchor" href="#generate-probabilities-of-imprinting-to-custom-subsets-of-influenza-a-viruses"></a>
</h2>
<p>By default, <code><a href="../reference/get_imprinting_probabilities.html">get_imprinting_probabilities()</a></code> calculates
subtype-specific probabilities of imprinting to influenza A H1N1, H2N2,
or H3N2. Researchers may want to calculate different kinds of imprinting
probabilities. E.g. perhaps we want to study imprinting to specific
influenza isolates, clades, <a href="https://doi.org/10.1128/mBio.00204-19" class="external-link">glycosylation states</a>,
or to a multivalent vaccine.</p>
<p>To calculate imprinting to custom groups of influenza A viruses, use
the <code>annual_frequencies</code> option in
<code><a href="../reference/get_imprinting_probabilities.html">get_imprinting_probabilities()</a></code>.</p>
<p>The <code>annual_frequencies</code> input must be a list whose names
match the <code>countries</code> input. Each element of the list must be
a data frame or tibble with the following columns:</p>
<ul>
<li>
<code>year</code> - containing numeric values from
1918-max(<code>observation_years</code>)</li>
<li>any number of frequency columns whose names indicate the imprinting
category, and whose values indicate the annual fraction of circulating
influenza A exposures in that category. Within each year (row), these
values must sum to one.</li>
</ul>
<p>As an example, let’s imagine we want to calculate subtype-specific
imprinting probabilities, with some probability of imprinting by
vaccination in the United States and Germany. Note that the pediatric
influenza vaccination rates used in this example are PURELY
HYPOTEHTICAL, and not based on data or actual vaccine policies in these
countries.</p>
<p>Let’s start by making a data frame of circulation frequencies for the
United States.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cobeylab.github.io/imprinting/">imprinting</a></span><span class="op">)</span></span>
<span><span class="co">## Start with subtype-specific fractions for H1N1, H2N2, H3N2</span></span>
<span><span class="va">US_frequencies</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_country_cocirculation_data.html">get_country_cocirculation_data</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">'United States'</span>, max_year <span class="op">=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">US_frequencies</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;    year `A/H1N1` `A/H2N2` `A/H3N2`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>918        1        0        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>919        1        0        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>920        1        0        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">1</span>921        1        0        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">1</span>922        1        0        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">1</span>923        1        0        0</span></span></code></pre></div>
<p>Now, add in a vaccination column. Not all countries vaccinate healthy
infants against influenza, and infant influenza vaccination has only
been widely practiced for the past few decades, even in countries where
coverage is now high. Hypothetically, let’s assume that 5% of US infants
were vaccinated against influenza starting in 1995, increasing steadily
to 75% coverage in 2020. (Again, this is purely hypothetical, and not
based on data.)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Add a vaccination column</span></span>
<span><span class="va">US_frequencies</span> <span class="op">&lt;-</span> <span class="va">US_frequencies</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>vaccination <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">77</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.75</span>, length <span class="op">=</span> <span class="fl">26</span><span class="op">)</span>, <span class="fl">.75</span>, <span class="fl">.75</span><span class="op">)</span>, <span class="co"># Add a vaccination column</span></span>
<span>         `A/H1N1` <span class="op">=</span> <span class="va">`A/H1N1`</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">vaccination</span><span class="op">)</span>, <span class="co"># Assume only non-vaccinated children have primary</span></span>
<span>         `A/H2N2` <span class="op">=</span> <span class="va">`A/H2N2`</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">vaccination</span><span class="op">)</span>, <span class="co"># infections; multiply the subtype-specific circulation</span></span>
<span>         `A/H3N2` <span class="op">=</span> <span class="va">`A/H3N2`</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">vaccination</span><span class="op">)</span><span class="op">)</span> <span class="co"># fractions by one minus the year's vaccination probability.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">US_frequencies</span>, n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 × 5</span></span></span>
<span><span class="co">#&gt;     year `A/H1N1` `A/H2N2` `A/H3N2` vaccination</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">1</span>993  0.105          0    0.895        0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">1</span>994  0.005<span style="text-decoration: underline;">22</span>        0    0.995        0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">1</span>995  0.010<span style="text-decoration: underline;">8</span>         0    0.489        0.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">1</span>996  0.288          0    0.202        0.51</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">1</span>997  0              0    0.48         0.52</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">1</span>998  0.004<span style="text-decoration: underline;">44</span>        0    0.466        0.53</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">1</span>999  0.003<span style="text-decoration: underline;">72</span>        0    0.456        0.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>000  0.130          0    0.320        0.55</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>001  0.335          0    0.105        0.56</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>002  0.015<span style="text-decoration: underline;">5</span>         0    0.415        0.57</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 20 more rows</span></span></span></code></pre></div>
<p>Assume Germany adopted their infant vaccination policy 10 years
later, in 2005. Generate a Germany-specific table of frequencies:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Germany_frequencies</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_country_cocirculation_data.html">get_country_cocirculation_data</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">'Germany'</span>,</span>
<span>                                                      max_year <span class="op">=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>vaccination <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">87</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.75</span>, length <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>, <span class="fl">.75</span>, <span class="fl">.75</span><span class="op">)</span>,</span>
<span>         `A/H1N1` <span class="op">=</span> <span class="va">`A/H1N1`</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">vaccination</span><span class="op">)</span>, <span class="co"># Assume only non-vaccinated children have primary</span></span>
<span>         `A/H2N2` <span class="op">=</span> <span class="va">`A/H2N2`</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">vaccination</span><span class="op">)</span>, <span class="co"># infections; multiply the subtype-specific circulation</span></span>
<span>         `A/H3N2` <span class="op">=</span> <span class="va">`A/H3N2`</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">vaccination</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">Germany_frequencies</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 5</span></span></span>
<span><span class="co">#&gt;     year `A/H1N1` `A/H2N2` `A/H3N2` vaccination</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>002 0               0   1           0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>003 0.000<span style="text-decoration: underline;">727</span>        0   0.999       0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>004 0               0   0.95        0.05  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>005 0.190           0   0.713       0.096<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>006 0.145           0   0.712       0.143 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>007 0.082<span style="text-decoration: underline;">0</span>          0   0.728       0.19  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>008 0.053<span style="text-decoration: underline;">7</span>          0   0.710       0.237 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>009 0.447           0   0.269       0.283 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>010 0.644           0   0.026<span style="text-decoration: underline;">4</span>      0.33  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>011 0.612           0   0.011<span style="text-decoration: underline;">1</span>      0.377 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">2</span>012 0.035<span style="text-decoration: underline;">2</span>          0   0.541       0.423 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  <span style="text-decoration: underline;">2</span>013 0.280           0   0.250       0.47  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  <span style="text-decoration: underline;">2</span>014 0.149           0   0.335       0.517 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  <span style="text-decoration: underline;">2</span>015 0.097<span style="text-decoration: underline;">7</span>          0   0.339       0.563 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  <span style="text-decoration: underline;">2</span>016 0.296           0   0.094<span style="text-decoration: underline;">5</span>      0.61  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  <span style="text-decoration: underline;">2</span>017 0.012<span style="text-decoration: underline;">8</span>          0   0.331       0.657 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>  <span style="text-decoration: underline;">2</span>018 0.255           0   0.041<span style="text-decoration: underline;">5</span>      0.703 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>  <span style="text-decoration: underline;">2</span>019 0.126           0   0.124       0.75  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>  <span style="text-decoration: underline;">2</span>020 0.121           0   0.129       0.75  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>  <span style="text-decoration: underline;">2</span>022 0.011<span style="text-decoration: underline;">0</span>          0   0.239       0.75</span></span></code></pre></div>
<div class="section level3">
<h3 id="input-the-custom-frequencies-into-get_imprinting_probabilities">Input the custom frequencies into
<code>get_imprinting_probabilities()</code><a class="anchor" aria-label="anchor" href="#input-the-custom-frequencies-into-get_imprinting_probabilities"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Check that all frequencies sum to 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">US_frequencies</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Germany_frequencies</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Wrap the country-specific frequencies into a named list</span></span>
<span><span class="va">input_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"United States"</span> <span class="op">=</span> <span class="va">US_frequencies</span>,</span>
<span>                  <span class="st">"Germany"</span> <span class="op">=</span> <span class="va">Germany_frequencies</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate probabilities</span></span>
<span><span class="fu"><a href="../reference/get_imprinting_probabilities.html">get_imprinting_probabilities</a></span><span class="op">(</span>observation_years <span class="op">=</span> <span class="fl">2022</span>, </span>
<span>                             countries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"United States"</span>, <span class="st">"Germany"</span><span class="op">)</span>, </span>
<span>                             annual_frequencies <span class="op">=</span> <span class="va">input_list</span>, </span>
<span>                             df_format <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 210 × 8</span></span></span>
<span><span class="co">#&gt;     year country       birth_year `A/H1N1` `A/H2N2` `A/H3N2` vaccination naive</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">1</span>918        1        0        0           0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">1</span>919        1        0        0           0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">1</span>920        1        0        0           0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">1</span>921        1        0        0           0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">1</span>922        1        0        0           0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">1</span>923        1        0        0           0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">1</span>924        1        0        0           0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">1</span>925        1        0        0           0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">1</span>926        1        0        0           0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>022 United States       <span style="text-decoration: underline;">1</span>927        1        0        0           0     0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 200 more rows</span></span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Katelyn Gostic, Alex Byrnes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
