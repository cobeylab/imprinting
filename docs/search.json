[{"path":"https://cobeylab.github.io/imprinting/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 imprinting authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":[]},{"path":"https://cobeylab.github.io/imprinting/Readme.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"imprinting","text":"imprinting R package reconstruct birth year-specific probabilities imprinting subtype influenza , H1N1, H2N2, H3N2. may add ability reconstruct imprinting influenza B future. Reconstructions done following methods (Gostic et al. 2016). get_imprinting_probabilities() returns data frame containing birth year-specific probabilities imprinting H1N1, H2N2, H3N2 individual input country year observation. show_available_countries() lists available countries (data Flu Mart), valid spellings. plot_one_country_year() plot_many_country_years() generates plots using outputs get_imprinting_probabilites(). generated probabilities may modified, plotted, used independent research. Please cite (Gostic et al. 2016), package (citation(\"imprinting\")).","code":""},{"path":"https://cobeylab.github.io/imprinting/Readme.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"imprinting","text":"imprinting yet available CRAN, development version can installed github, using devtools package:","code":"# Install devtools install.packages(\"devtools\") # Use devtools to install impritning from github devtools::install_github(\"cobeylab/imprinting\")"},{"path":"https://cobeylab.github.io/imprinting/Readme.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"imprinting","text":"","code":"library(imprinting)   ## Get imprinting probabilities probs = get_imprinting_probabilities(observation_years = c(2000, 2022),                              countries = c('United States', 'Brazil', 'Vietnam', 'Indonesia')) probs #> # A tibble: 3,360 × 5 #>   subtype  year country       birth_year imprinting_prob #>   <chr>   <int> <chr>              <int>           <dbl> #> 1 H1N1     2000 United States       2022               0 #> 2 H1N1     2000 United States       2021               0 #> 3 H1N1     2000 United States       2020               0 #> 4 H1N1     2000 United States       2019               0 #> 5 H1N1     2000 United States       2018               0 #> # … with 3,355 more rows ## Plot imprinting probabilities  ##  - up to five countries ##  - show aging of birth cohorts from first to last observation year plot_many_country_years(probs) ## Plot imprinting probabilities ##  - select the first country year in the probs tibble by default plot_one_country_year(probs)"},{"path":"https://cobeylab.github.io/imprinting/Readme.html","id":"data","dir":"","previous_headings":"","what":"Data","title":"imprinting","text":"two main kinds data used reconstruct birth year-specific imprinting probailities. single epidemiological data source documents entire circulation history influenza 1918-present, pull various sources.","code":""},{"path":"https://cobeylab.github.io/imprinting/Readme.html","id":"id_1-cocirculation-data","dir":"","previous_headings":"","what":"1. Cocirculation data","title":"imprinting","text":"Cocirculation data describes relative dominance influenza subtype (H1N1, H2N2, H3N2) circulation year. informed following data: 1918-1976 Based available historical data, assume one subtype circulated year: 1918-1956: H1N1 1957-1967: H2N2 1968-1976: H3N2 1977-1996 Two subtypes, H1N1 H3N2, co-circulated globally, country-specific influenza surveillance data publicly available time period. use data number influenza specimens tested positive influenza subtype US surveillance (Table 1 Thompson et al. JAMA, 2003) calculate fraction circulation caused subtype. 1996-present Two subtypes, H1N1 H3N2, continue co-circulate globally. pull country-specific data Flu Mart() estimate fraction specimens tested positive subtype H1N1 H3N2. country reported fewer min_samples (default 30) influenza -positive specimens given year, substitute data country’s Region ensure sufficient sample size.","code":""},{"path":"https://cobeylab.github.io/imprinting/Readme.html","id":"id_2-intensity-data","dir":"","previous_headings":"","what":"2. Intensity data","title":"imprinting","text":"Children likely imprint years high levels influenza circulation. define annual intensity score characterize annual circulation intensity, scale annual probability primary infection. definition, circulation intensity 1 indicates average levels influenza ciruclation. use three kinds data characterize annual circulation intensity: 1918-1996, calculate annual intensity using methods Gostic et al. 2016. 1918-1976, intensity scores informed Pneumonia Influenza excess mortaltity estimates Housworth et al. 1974, 1976-1977, intensity scores informed influenza test-positive fraction reported Table 1 Thompson et al. JAMA, 2003. 1997-present, calculate country region-specific intensities using surveillance data Flu Mart. Intensity calculated : [fraction processed samples positive flu ]/[mean fraction processed samples positive flu ]. Country-specific data used default. Regional data substituted insufficient number country-specific specimens.","code":""},{"path":"https://cobeylab.github.io/imprinting/Readme.html","id":"bugs","dir":"","previous_headings":"","what":"Bugs","title":"imprinting","text":"report bugs, please file issue reproducible example github.com/cobeylab/imprinting.","code":""},{"path":"https://cobeylab.github.io/imprinting/articles/custom-imprinting-types.html","id":"generate-probabilities-of-imprinting-to-custom-subsets-of-influenza-a-viruses","dir":"Articles","previous_headings":"","what":"Generate probabilities of imprinting to custom subsets of influenza A viruses","title":"custom-imprinting-types","text":"default, get_imprinting_probabilities() calculates subtype-specific probabilities imprinting influenza H1N1, H2N2, H3N2. Researchers may want calculate different kinds imprinting probabilities. E.g. perhaps want study imprinting specific influenza isolates, clades, glycosylation states, multivalent vaccine. calculate imprinting custom groups influenza viruses, use annual_frequencies option get_imprinting_probabilities(). annual_frequencies input must list whose names match countries input. element list must data frame tibble following columns: year - containing numeric values 1918-max(observation_years) number frequency columns whose names indicate imprinting category, whose values indicate annual fraction circulating influenza exposures category. Within year (row), values must sum one. example, let’s imagine want calculate subtype-specific imprinting probabilities, probability imprinting vaccination United States Germany. Note pediatric influenza vaccination rates used example PURELY HYPOTEHTICAL, based data actual vaccine policies countries. Let’s start making data frame circulation frequencies United States. Now, add vaccination column. countries vaccinate healthy infants influenza, infant influenza vaccination widely practiced past decades, even countries coverage now high. Hypothetically, let’s assume 5% US infants vaccinated influenza starting 1995, increasing steadily 75% coverage 2020. (, purely hypothetical, based data.) Assume Germany adopted infant vaccination policy 10 years later, 2005. Generate Germany-specific table frequencies:","code":"library(imprinting) ## Start with subtype-specific fractions for H1N1, H2N2, H3N2 US_frequencies = get_country_cocirculation_data(country = 'United States', max_year = 2022) %>%   select(1:4) head(US_frequencies) #> # A tibble: 6 × 4 #>    year `A/H1N1` `A/H2N2` `A/H3N2` #>   <dbl>    <dbl>    <dbl>    <dbl> #> 1  1918        1        0        0 #> 2  1919        1        0        0 #> 3  1920        1        0        0 #> 4  1921        1        0        0 #> 5  1922        1        0        0 #> 6  1923        1        0        0 ## Add a vaccination column US_frequencies <- US_frequencies %>%   mutate(vaccination = c(rep(0, 77), seq(.5, .75, length = 26), .75, .75), # Add a vaccination column          `A/H1N1` = `A/H1N1`*(1-vaccination), # Assume only non-vaccinated children have primary          `A/H2N2` = `A/H2N2`*(1-vaccination), # infections; multiply the subtype-specific circulation          `A/H3N2` = `A/H3N2`*(1-vaccination)) # fractions by one minus the year's vaccination probability. tail(US_frequencies, n = 30) #> # A tibble: 30 × 5 #>     year `A/H1N1` `A/H2N2` `A/H3N2` vaccination #>    <dbl>    <dbl>    <dbl>    <dbl>       <dbl> #>  1  1993  0.105          0    0.895        0    #>  2  1994  0.00522        0    0.995        0    #>  3  1995  0.0108         0    0.489        0.5  #>  4  1996  0.288          0    0.202        0.51 #>  5  1997  0              0    0.48         0.52 #>  6  1998  0.00444        0    0.466        0.53 #>  7  1999  0.00372        0    0.456        0.54 #>  8  2000  0.130          0    0.320        0.55 #>  9  2001  0.335          0    0.105        0.56 #> 10  2002  0.0155         0    0.415        0.57 #> # … with 20 more rows Germany_frequencies <- get_country_cocirculation_data(country = 'Germany',                                                       max_year = 2022) %>%   select(1:4) %>%   mutate(vaccination = c(rep(0, 87), seq(.05, .75, length = 16), .75, .75),          `A/H1N1` = `A/H1N1`*(1-vaccination), # Assume only non-vaccinated children have primary          `A/H2N2` = `A/H2N2`*(1-vaccination), # infections; multiply the subtype-specific circulation          `A/H3N2` = `A/H3N2`*(1-vaccination)) tail(Germany_frequencies, 20) #> # A tibble: 20 × 5 #>     year `A/H1N1` `A/H2N2` `A/H3N2` vaccination #>    <dbl>    <dbl>    <dbl>    <dbl>       <dbl> #>  1  2002 0               0   1           0      #>  2  2003 0.000727        0   0.999       0      #>  3  2004 0               0   0.95        0.05   #>  4  2005 0.190           0   0.713       0.0967 #>  5  2006 0.145           0   0.712       0.143  #>  6  2007 0.0820          0   0.728       0.19   #>  7  2008 0.0537          0   0.710       0.237  #>  8  2009 0.447           0   0.269       0.283  #>  9  2010 0.644           0   0.0264      0.33   #> 10  2011 0.612           0   0.0111      0.377  #> 11  2012 0.0352          0   0.541       0.423  #> 12  2013 0.280           0   0.250       0.47   #> 13  2014 0.149           0   0.335       0.517  #> 14  2015 0.0977          0   0.339       0.563  #> 15  2016 0.296           0   0.0945      0.61   #> 16  2017 0.0128          0   0.331       0.657  #> 17  2018 0.255           0   0.0415      0.703  #> 18  2019 0.126           0   0.124       0.75   #> 19  2020 0.121           0   0.129       0.75   #> 20  2022 0.0110          0   0.239       0.75"},{"path":"https://cobeylab.github.io/imprinting/articles/custom-imprinting-types.html","id":"input-the-custom-frequencies-into-get_imprinting_probabilities","dir":"Articles","previous_headings":"Generate probabilities of imprinting to custom subsets of influenza A viruses","what":"Input the custom frequencies into get_imprinting_probabilities()","title":"custom-imprinting-types","text":"","code":"## Check that all frequencies sum to 1 rowSums(US_frequencies[,2:5]) #>   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 rowSums(Germany_frequencies[,2:5]) #>   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #>  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 # Wrap the country-specific frequencies into a named list input_list = list(\"United States\" = US_frequencies,                   \"Germany\" = Germany_frequencies)  ## Calculate probabilities get_imprinting_probabilities(observation_years = 2022,                               countries = c(\"United States\", \"Germany\"),                               annual_frequencies = input_list,                               df_format = \"wide\") #> # A tibble: 210 × 8 #>     year country       birth_year `A/H1N1` `A/H2N2` `A/H3N2` vaccination naive #>    <dbl> <chr>              <dbl>    <dbl>    <dbl>    <dbl>       <dbl> <dbl> #>  1  2022 United States       1918        1        0        0           0     0 #>  2  2022 United States       1919        1        0        0           0     0 #>  3  2022 United States       1920        1        0        0           0     0 #>  4  2022 United States       1921        1        0        0           0     0 #>  5  2022 United States       1922        1        0        0           0     0 #>  6  2022 United States       1923        1        0        0           0     0 #>  7  2022 United States       1924        1        0        0           0     0 #>  8  2022 United States       1925        1        0        0           0     0 #>  9  2022 United States       1926        1        0        0           0     0 #> 10  2022 United States       1927        1        0        0           0     0 #> # … with 200 more rows"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"install-the-imprinting-package","dir":"Articles","previous_headings":"","what":"1. Install the imprinting package","title":"intro-to-imprinting","text":"imprinting package isn’t yet available CRAN, can’t yet installed using normal install.packages(\"imprinting\") command R. (feature coming soon!) now, install package github using following steps.","code":""},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"install-the-devtools-package","dir":"Articles","previous_headings":"1. Install the imprinting package","what":"1.1 Install the devtools package","title":"intro-to-imprinting","text":"prompted: need researt R prior lading, need install souce.","code":"install.packages(\"devtools\", repos='http://cran.us.r-project.org')"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"load-the-devtools-package","dir":"Articles","previous_headings":"1. Install the imprinting package","what":"1.2 Load the devtools package","title":"intro-to-imprinting","text":"Now devtools installed, can use install_github() function install imprinting package.","code":"library(devtools) # Load the package #> Loading required package: usethis"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"install-the-imprinting-package-from-github","dir":"Articles","previous_headings":"1. Install the imprinting package","what":"1.3 Install the imprinting package from github","title":"intro-to-imprinting","text":"builds installs package using source files https://github.com/cobeylab/imprinting.","code":"devtools::install_github(\"cobeylab/imprinting\")"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"load-the-imprinting-package","dir":"Articles","previous_headings":"1. Install the imprinting package","what":"1.4 Load the imprinting package","title":"intro-to-imprinting","text":"Now package installed loaded R workspace.","code":"library(imprinting)"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"use-the-package-to-calculate-imprinting-probabilities","dir":"Articles","previous_headings":"","what":"2. Use the package to calculate imprinting probabilities","title":"intro-to-imprinting","text":"main reason use imprinting package calculate birth year-specific probabilities imprinting specific subtype influenza . can read biology methods behind calculations Gostic et al. 2016.","code":""},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"calculate-imprinting-probabilities-for-one-country-and-year-of-observation","dir":"Articles","previous_headings":"2. Use the package to calculate imprinting probabilities","what":"2.1 Calculate imprinting probabilities for one country and year of observation","title":"intro-to-imprinting","text":"Use function get_imprinting_probabilities(). Run ?get_imprinting_probabilities help. function returns tibble wtih five columns: subtype, year, country, birth_year, imprinting_prob. column imprinting_prob gives probability someone born birth_year observed year imprinted subtype. can run command use df_format='wide' option output results wide format. displays imprinting probabilities cohort side--side","code":"get_imprinting_probabilities(observation_years = 2022, countries = \"United States\") #> # A tibble: 420 × 5 #>     year country       birth_year subtype imprinting_prob #>    <dbl> <chr>              <dbl> <chr>             <dbl> #>  1  2022 United States       2022 A/H1N1        0.0000297 #>  2  2022 United States       2021 A/H1N1        0.0000679 #>  3  2022 United States       2020 A/H1N1        0.0702    #>  4  2022 United States       2019 A/H1N1        0.152     #>  5  2022 United States       2018 A/H1N1        0.171     #>  6  2022 United States       2017 A/H1N1        0.147     #>  7  2022 United States       2016 A/H1N1        0.225     #>  8  2022 United States       2015 A/H1N1        0.169     #>  9  2022 United States       2014 A/H1N1        0.308     #> 10  2022 United States       2013 A/H1N1        0.321     #> # … with 410 more rows get_imprinting_probabilities(observation_years = 2022,                               countries = \"United States\",                               df_format = 'wide') #> # A tibble: 105 × 7 #>     year country       birth_year `A/H1N1` `A/H2N2` `A/H3N2` naive #>    <dbl> <chr>              <dbl>    <dbl>    <dbl>    <dbl> <dbl> #>  1  2022 United States       1918        1        0        0     0 #>  2  2022 United States       1919        1        0        0     0 #>  3  2022 United States       1920        1        0        0     0 #>  4  2022 United States       1921        1        0        0     0 #>  5  2022 United States       1922        1        0        0     0 #>  6  2022 United States       1923        1        0        0     0 #>  7  2022 United States       1924        1        0        0     0 #>  8  2022 United States       1925        1        0        0     0 #>  9  2022 United States       1926        1        0        0     0 #> 10  2022 United States       1927        1        0        0     0 #> # … with 95 more rows"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"why-do-we-specify-the-observation_year","dir":"Articles","previous_headings":"2. Use the package to calculate imprinting probabilities","what":"2.2 Why do we specify the observation_year?","title":"intro-to-imprinting","text":"observation_year affects imprinting probabilities birth cohorts young enough still process imprinting. model assumes everyone infected influenza age 12, cohorts <12 years age time observation, imprinting probabilities depend observation year. E.g. consider cohort born 2000: observation year 2005, birth cohort five years old, still young enough remain naive influenza. outputs show 22.9% cohort yet imprinted subtype. calculate imprinting probabilities birth cohort observed 2011 (age 11), model shows cohort imprinted, still small non-zero probability remaining naive. cohort reaches age 12, (observation year 2012) model enforces assumption everyone cohort imprinted. normalizes probabilities subtype-specific imprinting H1N1, H2N2, H3N2-specific probabilities sum 1, sets naive probability zero. cohort reaches age 12, imprinting probabilities fixed. outputs show imprinting probabilities 2000 cohort identical observed age 12 (2012), age 22 (2022). Note: added age_at_observation column outputs clarity.","code":"get_imprinting_probabilities(observation_years = c(2005, 2011, 2012, 2022),                               countries = \"United States\",                               df_format = 'wide') %>%   dplyr::filter(birth_year == 2000) %>%   mutate(age_at_observation = year-birth_year) %>%   select(c(1,2,3,8,4:7)) #> # A tibble: 4 × 8 #>    year country    birth_year age_at_observat… `A/H1N1` `A/H2N2` `A/H3N2`  naive #>   <dbl> <chr>           <dbl>            <dbl>    <dbl>    <dbl>    <dbl>  <dbl> #> 1  2005 United St…       2000                5    0.196        0    0.574 0.229  #> 2  2011 United St…       2000               11    0.322        0    0.667 0.0104 #> 3  2012 United St…       2000               12    0.324        0    0.676 0      #> 4  2022 United St…       2000               22    0.324        0    0.676 0"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"view-a-list-of-the-available-countries","dir":"Articles","previous_headings":"2. Use the package to calculate imprinting probabilities","what":"2.2 View a list of the available countries","title":"intro-to-imprinting","text":"can calculate imprinting probabilities countries data Flu Net. input name spelling must match outputs :","code":"show_available_countries() %>%   print(n = 200) #> # A tibble: 175 × 1 #>     country                          #>     <chr>                            #>   1 Afghanistan                      #>   2 Albania                          #>   3 Algeria                          #>   4 Angola                           #>   5 Anguilla                         #>   6 Antigua and Barbuda              #>   7 Argentina                        #>   8 Armenia                          #>   9 Aruba                            #>  10 Australia                        #>  11 Austria                          #>  12 Azerbaijan                       #>  13 Bahamas                          #>  14 Bahrain                          #>  15 Bangladesh                       #>  16 Barbados                         #>  17 Belarus                          #>  18 Belgium                          #>  19 Belize                           #>  20 Bermuda                          #>  21 Bhutan                           #>  22 Bolivia                          #>  23 Bosnia and Herzegovina           #>  24 Brazil                           #>  25 British Virgin Islands           #>  26 Bulgaria                         #>  27 Burkina Faso                     #>  28 Cabo Verde                       #>  29 Cambodia                         #>  30 Cameroon                         #>  31 Canada                           #>  32 Cayman Islands                   #>  33 Central African Republic         #>  34 Chad                             #>  35 Chile                            #>  36 China                            #>  37 Colombia                         #>  38 Congo                            #>  39 Costa Rica                       #>  40 Cote d'Ivoire                    #>  41 Croatia                          #>  42 Cuba                             #>  43 Cyprus                           #>  44 Czechia                          #>  45 Democratic Republic of Congo     #>  46 Denmark                          #>  47 Dominica                         #>  48 Dominican Republic               #>  49 Ecuador                          #>  50 Egypt                            #>  51 El Salvador                      #>  52 Estonia                          #>  53 Ethiopia                         #>  54 Fiji                             #>  55 Finland                          #>  56 France                           #>  57 French Guiana                    #>  58 Gambia                           #>  59 Georgia                          #>  60 Germany                          #>  61 Ghana                            #>  62 Greece                           #>  63 Grenada                          #>  64 Guadeloupe                       #>  65 Guatemala                        #>  66 Guinea                           #>  67 Guinea-Bissau                    #>  68 Guyana                           #>  69 Haiti                            #>  70 Honduras                         #>  71 Hungary                          #>  72 Iceland                          #>  73 India                            #>  74 Indonesia                        #>  75 Iran                             #>  76 Iraq                             #>  77 Ireland                          #>  78 Israel                           #>  79 Italy                            #>  80 Jamaica                          #>  81 Japan                            #>  82 Jordan                           #>  83 Kazakhstan                       #>  84 Kenya                            #>  85 Kosovo                           #>  86 Kuwait                           #>  87 Kyrgyzstan                       #>  88 Laos                             #>  89 Latvia                           #>  90 Lebanon                          #>  91 Lithuania                        #>  92 Luxembourg                       #>  93 Madagascar                       #>  94 Malaysia                         #>  95 Maldives                         #>  96 Mali                             #>  97 Malta                            #>  98 Martinique                       #>  99 Mauritania                       #> 100 Mauritius                        #> 101 Mexico                           #> 102 Moldova                          #> 103 Mongolia                         #> 104 Montenegro                       #> 105 Morocco                          #> 106 Mozambique                       #> 107 Myanmar                          #> 108 Namibia                          #> 109 Nepal                            #> 110 Netherlands                      #> 111 New Caledonia                    #> 112 New Zealand                      #> 113 Nicaragua                        #> 114 Niger                            #> 115 Nigeria                          #> 116 North Korea                      #> 117 North Macedonia                  #> 118 Norway                           #> 119 Oman                             #> 120 Pakistan                         #> 121 Palestine                        #> 122 Panama                           #> 123 Papua New Guinea                 #> 124 Paraguay                         #> 125 Peru                             #> 126 Philippines                      #> 127 Poland                           #> 128 Portugal                         #> 129 Qatar                            #> 130 Romania                          #> 131 Russia                           #> 132 Rwanda                           #> 133 Saint Kitts and Nevis            #> 134 Saint Lucia                      #> 135 Saint Vincent and the Grenadines #> 136 Saudi Arabia                     #> 137 Senegal                          #> 138 Serbia                           #> 139 Seychelles                       #> 140 Sierra Leone                     #> 141 Singapore                        #> 142 Slovakia                         #> 143 Slovenia                         #> 144 South Africa                     #> 145 South Korea                      #> 146 South Sudan                      #> 147 Spain                            #> 148 Sri Lanka                        #> 149 Sudan                            #> 150 Suriname                         #> 151 Sweden                           #> 152 Switzerland                      #> 153 Syria                            #> 154 Tajikistan                       #> 155 Tanzania                         #> 156 Thailand                         #> 157 Timor                            #> 158 Togo                             #> 159 Trinidad and Tobago              #> 160 Tunisia                          #> 161 Turkey                           #> 162 Turkmenistan                     #> 163 Turks and Caicos                 #> 164 Uganda                           #> 165 Ukraine                          #> 166 United Arab Emirates             #> 167 United Kingdom                   #> 168 United States                    #> 169 Uruguay                          #> 170 Uzbekistan                       #> 171 Venezuela                        #> 172 Vietnam                          #> 173 Yemen                            #> 174 Zambia                           #> 175 Zimbabwe"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"generate-probabilities-for-many-countries-and-observation-years","dir":"Articles","previous_headings":"2. Use the package to calculate imprinting probabilities","what":"2.3 Generate probabilities for many countries and observation years","title":"intro-to-imprinting","text":"Alternatively, can view outputs separate window save .csv file hard drive.","code":"many_probabilities = get_imprinting_probabilities(observation_years = c(2000, 2019, 2022),                                                   countries = c('Brazil', 'Afghanistan', 'Estonia', 'Finland'))  ## Store the outputs in a variable called many_probabilities many_probabilities ## View the outputs in the console #> # A tibble: 5,040 × 5 #>     year country     birth_year subtype imprinting_prob #>    <dbl> <chr>            <dbl> <chr>             <dbl> #>  1  2000 Brazil            2022 A/H1N1          0.331   #>  2  2019 Brazil            2022 A/H1N1          0.197   #>  3  2022 Brazil            2022 A/H1N1          0       #>  4  2000 Afghanistan       2022 A/H1N1          0.536   #>  5  2019 Afghanistan       2022 A/H1N1          0.110   #>  6  2022 Afghanistan       2022 A/H1N1          0.00138 #>  7  2000 Estonia           2022 A/H1N1          0.485   #>  8  2019 Estonia           2022 A/H1N1          0.188   #>  9  2022 Estonia           2022 A/H1N1          0       #> 10  2000 Finland           2022 A/H1N1          0.239   #> # … with 5,030 more rows # View the outputs in a separate window. View(many_probabilities)   # Save the outputs as a .csv file in your current working directory. write_csv(many_probabilities, 'many_probabilities.csv')"},{"path":[]},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"plot-the-first-country-year-combination-in-the-output-data-frame","dir":"Articles","previous_headings":"3. Plot the outputs","what":"3.1 Plot the first country-year combination in the output data frame","title":"intro-to-imprinting","text":"plot_one_country_year() takes long-formatted output data frame plots first country year combination.","code":"head(many_probabilities) #> # A tibble: 6 × 5 #>    year country     birth_year subtype imprinting_prob #>   <dbl> <chr>            <dbl> <chr>             <dbl> #> 1  2000 Brazil            2022 A/H1N1          0.331   #> 2  2019 Brazil            2022 A/H1N1          0.197   #> 3  2022 Brazil            2022 A/H1N1          0       #> 4  2000 Afghanistan       2022 A/H1N1          0.536   #> 5  2019 Afghanistan       2022 A/H1N1          0.110   #> 6  2022 Afghanistan       2022 A/H1N1          0.00138 plot_one_country_year(many_probabilities)"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"select-a-specific-country-and-year-to-plot","dir":"Articles","previous_headings":"3. Plot the outputs","what":"Select a specific country and year to plot","title":"intro-to-imprinting","text":"can use filter() select specific country year plotting.","code":"plot_one_country_year(many_probabilities %>%                          dplyr::filter(country == 'Estonia', year == 2019))"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"plot-up-to-five-countires-at-a-time","dir":"Articles","previous_headings":"3. Plot the outputs","what":"3.2 Plot up to five countires at a time","title":"intro-to-imprinting","text":"plot_many_country_years() generates plot first five countries imprinting outputs, across arbitrary number years. plots left show imprinting probabilities latest observation year plots right show H3N2 imprinting probabilities changed cohorts grow older earliest latest observation year outputs. vertical lines arrow show aging 1968 birth cohort.","code":"plot_many_country_years(many_probabilities)"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"explore-the-underlying-data-and-components-of-the-imprinting-probabilities","dir":"Articles","previous_headings":"","what":"4. Explore the underlying data and components of the imprinting probabilities","title":"intro-to-imprinting","text":"Get fraction influenza circulation caused subtype epidemic year 1918-2022 United States using get_country_cocirculation. Run ?get_country_cocirculation_data notes data sources. Get circulation intensity influenza epidemic year using get_country_intensity_data(). Intensity 1 average. Higher values indicate influenza circulation, lower values indicate less circulation. See ?get_country_intensity_data details underlying data.","code":"get_country_cocirculation_data('United States', 2022) #> # A tibble: 105 × 9 #>     year `A/H1N1` `A/H2N2` `A/H3N2`     A B     group1 group2 data_from          #>    <dbl>    <dbl>    <dbl>    <dbl> <dbl> <lgl>  <dbl>  <dbl> <chr>              #>  1  1918        1        0        0     1 NA         1      0 Historical_assump… #>  2  1919        1        0        0     1 NA         1      0 Historical_assump… #>  3  1920        1        0        0     1 NA         1      0 Historical_assump… #>  4  1921        1        0        0     1 NA         1      0 Historical_assump… #>  5  1922        1        0        0     1 NA         1      0 Historical_assump… #>  6  1923        1        0        0     1 NA         1      0 Historical_assump… #>  7  1924        1        0        0     1 NA         1      0 Historical_assump… #>  8  1925        1        0        0     1 NA         1      0 Historical_assump… #>  9  1926        1        0        0     1 NA         1      0 Historical_assump… #> 10  1927        1        0        0     1 NA         1      0 Historical_assump… #> # … with 95 more rows get_country_intensity_data(country = 'China', max_year = 2022) #> # A tibble: 113 × 2 #>     year intensity #>    <dbl>     <dbl> #>  1  1911      1    #>  2  1912      1    #>  3  1913      1    #>  4  1914      1    #>  5  1915      1.12 #>  6  1916      1.29 #>  7  1917      1.23 #>  8  1918      2.5  #>  9  1919      2.5  #> 10  1920      1.87 #> # … with 103 more rows"},{"path":"https://cobeylab.github.io/imprinting/articles/intro-to-imprinting.html","id":"get-the-probability-that-an-individual-imprinted-0-1-2-12-years-after-birth","dir":"Articles","previous_headings":"4. Explore the underlying data and components of the imprinting probabilities","what":"Get the probability that an individual imprinted 0, 1, 2, … 12 years after birth","title":"intro-to-imprinting","text":"Use function get_p_infection_year()","code":"probs = get_p_infection_year(birth_year = 2000,                      observation_year = 2022,                      intensity_df = get_country_intensity_data('Mexico', 2022),                      max_year = 2022) names(probs) = as.character(2000+(0:12)) probs #>        2000        2001        2002        2003        2004        2005  #> 0.014797424 0.038348694 0.014337222 0.078764203 0.015525076 0.093914147  #>        2006        2007        2008        2009        2010        2011  #> 0.007673805 0.058215925 0.017624843 0.462559063 0.119102374 0.013750798  #>        2012  #> 0.036377222 sum(probs) ## Raw probabilities are not yet normalized. #> [1] 0.9709908  norm_probs = probs/sum(probs) ## Normalize sum(norm_probs) #> [1] 1"},{"path":"https://cobeylab.github.io/imprinting/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Katelyn Gostic. Author. Alex Byrnes. Contributor, maintainer.","code":""},{"path":"https://cobeylab.github.io/imprinting/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gostic K (2022). imprinting: Calculate Birth Year-Specific Probabilities Immune Imprinting Influenza. R package version 0.1.0, https://cobeylab.github.io/imprinting/.","code":"@Manual{,   title = {imprinting: Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza},   author = {Katelyn Gostic},   year = {2022},   note = {R package version 0.1.0},   url = {https://cobeylab.github.io/imprinting/}, }"},{"path":[]},{"path":"https://cobeylab.github.io/imprinting/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza","text":"imprinting R package reconstruct birth year-specific probabilities imprinting influenza . Reconstructions done following methods (Gostic et al. 2016). default package calculates subtype-specific probabilities imprinting H1N1, H2N2, H3N2, possible calculate kinds imprinting probabilities (e.g. clade-level, strain-level, vaccination) using user-provided circulation frequencies. may consider including influenza B-specific probabilities future updates demand. Please submit issue let us know need influenza B-specific functionality. get_imprinting_probabilities() returns data frame containing birth year-specific probabilities imprinting H1N1, H2N2, H3N2 individual input country year observation. show_available_countries() lists available countries (data Flu Mart), valid spellings. plot_one_country_year() plot_many_country_years() generates plots using outputs get_imprinting_probabilites(). generated probabilities may modified, plotted, used independent research. Please cite (Gostic et al. 2016), package (citation(\"imprinting\")).","code":""},{"path":"https://cobeylab.github.io/imprinting/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza","text":"imprinting yet available CRAN, development version can installed github, using devtools package:","code":"# Install devtools install.packages(\"devtools\") # Use devtools to install impritning from github devtools::install_github(\"cobeylab/imprinting\")"},{"path":"https://cobeylab.github.io/imprinting/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza","text":"","code":"library(imprinting)   ## Get imprinting probabilities probs = get_imprinting_probabilities(observation_years = c(2000, 2022),                              countries = c('United States', 'Brazil', 'Vietnam', 'Indonesia')) probs #> # A tibble: 3,360 × 5 #>    year country       birth_year subtype imprinting_prob #>   <dbl> <chr>              <dbl> <chr>             <dbl> #> 1  2000 United States       2022 A/H1N1        0.297     #> 2  2022 United States       2022 A/H1N1        0.0000297 #> 3  2000 Brazil              2022 A/H1N1        0.331     #> 4  2022 Brazil              2022 A/H1N1        0         #> 5  2000 Vietnam             2022 A/H1N1        0.267     #> # … with 3,355 more rows ## Plot imprinting probabilities  ##  - up to five countries ##  - show aging of birth cohorts from first to last observation year plot_many_country_years(probs) ## Plot imprinting probabilities ##  - select the first country year in the probs tibble by default plot_one_country_year(probs)"},{"path":"https://cobeylab.github.io/imprinting/index.html","id":"data","dir":"","previous_headings":"","what":"Data","title":"Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza","text":"two main kinds data used reconstruct birth year-specific imprinting probailities. single epidemiological data source documents entire circulation history influenza 1918-present, pull various sources.","code":""},{"path":"https://cobeylab.github.io/imprinting/index.html","id":"id_1-cocirculation-data","dir":"","previous_headings":"","what":"1. Cocirculation data","title":"Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza","text":"Cocirculation data describes relative dominance influenza subtype (H1N1, H2N2, H3N2) circulation year. informed following data: 1918-1976 Based available historical data, assume one subtype circulated year: 1918-1956: H1N1 1957-1967: H2N2 1968-1976: H3N2 1977-1996 Two subtypes, H1N1 H3N2, co-circulated globally, country-specific influenza surveillance data publicly available time period. use data number influenza specimens tested positive influenza subtype US surveillance (Table 1 Thompson et al. JAMA, 2003) calculate fraction circulation caused subtype. 1996-present Two subtypes, H1N1 H3N2, continue co-circulate globally. pull country-specific data Flu Mart() estimate fraction specimens tested positive subtype H1N1 H3N2. country reported fewer min_samples (default 30) influenza -positive specimens given year, substitute data country’s Region ensure sufficient sample size.","code":""},{"path":"https://cobeylab.github.io/imprinting/index.html","id":"id_2-intensity-data","dir":"","previous_headings":"","what":"2. Intensity data","title":"Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza","text":"Children likely imprint years high levels influenza circulation. define annual intensity score characterize annual circulation intensity, scale annual probability primary infection. definition, circulation intensity 1 indicates average levels influenza ciruclation. use three kinds data characterize annual circulation intensity: 1918-1996, calculate annual intensity using methods Gostic et al. 2016. 1918-1976, intensity scores informed Pneumonia Influenza excess mortaltity estimates Housworth et al. 1974, 1976-1977, intensity scores informed influenza test-positive fraction reported Table 1 Thompson et al. JAMA, 2003. 1997-present, calculate country region-specific intensities using surveillance data Flu Mart. Intensity calculated : [fraction processed samples positive flu ]/[mean fraction processed samples positive flu ]. Country-specific data used default. Regional data substituted insufficient number country-specific specimens.","code":""},{"path":"https://cobeylab.github.io/imprinting/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza","text":"Development R package supported NIH Centers Excellence Influenza Research Response (CEIRR) Network National Institutes Health contract number 75N93021C00015. content solely responsibility authors necessarily represent official views National Institutes Health.","code":""},{"path":"https://cobeylab.github.io/imprinting/index.html","id":"bugs","dir":"","previous_headings":"","what":"Bugs","title":"Calculate Birth Year-Specific Probabilities of Immune Imprinting to Influenza","text":"report bugs, please file issue reproducible example github.com/cobeylab/imprinting.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_WHO_region.html","id":null,"dir":"Reference","previous_headings":"","what":"Look up a country's WHO region — get_WHO_region","title":"Look up a country's WHO region — get_WHO_region","text":"Look country's region","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_WHO_region.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Look up a country's WHO region — get_WHO_region","text":"","code":"get_WHO_region(this.country)"},{"path":"https://cobeylab.github.io/imprinting/reference/get_WHO_region.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Look up a country's WHO region — get_WHO_region","text":".country name input country (string)","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_WHO_region.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Look up a country's WHO region — get_WHO_region","text":"Name corresponding region","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_WHO_region.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Look up a country's WHO region — get_WHO_region","text":"","code":"get_WHO_region(\"Germany\") #> [1] \"europe\" get_WHO_region(\"China\") #> [1] \"western_pacific\""},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_cocirculation_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get data on the relative circulation of each influenza A subtype — get_country_cocirculation_data","title":"Get data on the relative circulation of each influenza A subtype — get_country_cocirculation_data","text":"get_country_cocirculation_data() imports data fraction influenza cases specific country year caused influenza subtype (H1N1, H2N2, H3N2), group (group 1 group 2). Group 1 contains H1N1 H2N2, group 2 contains H2N2.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_cocirculation_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get data on the relative circulation of each influenza A subtype — get_country_cocirculation_data","text":"","code":"get_country_cocirculation_data(   country,   max_year,   min_samples = 30,   output_format = \"tibble\" )"},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_cocirculation_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get data on the relative circulation of each influenza A subtype — get_country_cocirculation_data","text":"country country interest. Run show_available_countries() list valid inputs. max_year last year interest. Results generated 1918:max_year. min_samples fewer min_samples (default 30) reported country year interest, function substitute data corresponding region. output_format can 'tibble' (default) 'matrix' (used mainly convenience within functions)","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_cocirculation_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get data on the relative circulation of each influenza A subtype — get_country_cocirculation_data","text":"matrix rows showing calendar year, fraction influenza -positive specimens subtype (rows /H1N1, /H2N2, /H3N2), HA group (rows group 1, group 2). Row always 1, shows sum subtype-specific fractions. Row B placeholder whose values NA.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_cocirculation_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get data on the relative circulation of each influenza A subtype — get_country_cocirculation_data","text":"data come three sources: Historical assumptions: 1918-1956, assume H1N1 circulated. 1957-1967, assume H2N2 circulated. 1968-1976, assume H3N2 circulated. Thompson et al. JAMA, 2003: 1977-1996 pull data relative dominance H1N1 H3N2 Table 1 Thompson et al. 2003, reports surveillance data collected United States. 1997-present, pull country region-specific data Flu Mart fraction specimens collected routine influenza surveillance test positive subtype. Country-specific data default. Regional data, global data used number country region-specific specimens insufficient. get_template_data() imports data 1918-1996. get_country_inputs_1997_to_present() get_regional_inputs_1997_to_present() import data 1997 .","code":""},{"path":[]},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_cocirculation_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get data on the relative circulation of each influenza A subtype — get_country_cocirculation_data","text":"","code":"get_country_cocirculation_data(\"United States\", \"2019\") #> # A tibble: 105 × 9 #>     year `A/H1N1` `A/H2N2` `A/H3N2`     A B     group1 group2 data_from          #>    <dbl>    <dbl>    <dbl>    <dbl> <dbl> <lgl>  <dbl>  <dbl> <chr>              #>  1  1918        1        0        0     1 NA         1      0 Historical_assump… #>  2  1919        1        0        0     1 NA         1      0 Historical_assump… #>  3  1920        1        0        0     1 NA         1      0 Historical_assump… #>  4  1921        1        0        0     1 NA         1      0 Historical_assump… #>  5  1922        1        0        0     1 NA         1      0 Historical_assump… #>  6  1923        1        0        0     1 NA         1      0 Historical_assump… #>  7  1924        1        0        0     1 NA         1      0 Historical_assump… #>  8  1925        1        0        0     1 NA         1      0 Historical_assump… #>  9  1926        1        0        0     1 NA         1      0 Historical_assump… #> 10  1927        1        0        0     1 NA         1      0 Historical_assump… #> # … with 95 more rows get_country_cocirculation_data(\"Laos\", \"2022\", min_samples = 40) #> # A tibble: 105 × 9 #>     year `A/H1N1` `A/H2N2` `A/H3N2`     A B     group1 group2 data_from          #>    <dbl>    <dbl>    <dbl>    <dbl> <dbl> <lgl>  <dbl>  <dbl> <chr>              #>  1  1918        1        0        0     1 NA         1      0 Historical_assump… #>  2  1919        1        0        0     1 NA         1      0 Historical_assump… #>  3  1920        1        0        0     1 NA         1      0 Historical_assump… #>  4  1921        1        0        0     1 NA         1      0 Historical_assump… #>  5  1922        1        0        0     1 NA         1      0 Historical_assump… #>  6  1923        1        0        0     1 NA         1      0 Historical_assump… #>  7  1924        1        0        0     1 NA         1      0 Historical_assump… #>  8  1925        1        0        0     1 NA         1      0 Historical_assump… #>  9  1926        1        0        0     1 NA         1      0 Historical_assump… #> 10  1927        1        0        0     1 NA         1      0 Historical_assump… #> # … with 95 more rows"},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_inputs_1997_to_present.html","id":null,"dir":"Reference","previous_headings":"","what":"Return raw flu surveillance data for a specific country — get_country_inputs_1997_to_present","title":"Return raw flu surveillance data for a specific country — get_country_inputs_1997_to_present","text":"Load return tibble containing raw influenza surveillance data country interest. Data Flu Mart.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_inputs_1997_to_present.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return raw flu surveillance data for a specific country — get_country_inputs_1997_to_present","text":"","code":"get_country_inputs_1997_to_present(country, max_year)"},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_inputs_1997_to_present.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return raw flu surveillance data for a specific country — get_country_inputs_1997_to_present","text":"country name country. Run show_available_countries() list options. max_year results output available years max_year.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_inputs_1997_to_present.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return raw flu surveillance data for a specific country — get_country_inputs_1997_to_present","text":"tibble following columns: Country: name region Year: calendar year surveillance n_processed: total specimens processed","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_inputs_1997_to_present.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return raw flu surveillance data for a specific country — get_country_inputs_1997_to_present","text":"","code":"get_country_inputs_1997_to_present(\"Aruba\", 1998) #> # A tibble: 2 × 9 #>   Country  Year n_H1N1 n_H3N2   n_A n_BYam n_BVic   n_B n_processed #>   <chr>   <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>       <dbl> #> 1 Aruba    1997      0      0     0      0      0     0           0 #> 2 Aruba    1998      0      0     0      0      0     0           0 get_country_inputs_1997_to_present(\"Honduras\", 2022) #> # A tibble: 26 × 9 #>    Country   Year n_H1N1 n_H3N2   n_A n_BYam n_BVic   n_B n_processed #>    <chr>    <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>       <dbl> #>  1 Honduras  1997      0      0     0      0      0     0           0 #>  2 Honduras  1998      0      0     0      0      0     0           0 #>  3 Honduras  1999      0      0     0      0      0     0           0 #>  4 Honduras  2000      0      0     0      0      0     0           0 #>  5 Honduras  2001      0      0     0      0      0     0           0 #>  6 Honduras  2002      0      0     0      0      0     0           0 #>  7 Honduras  2003      0      0     0      0      0     0           0 #>  8 Honduras  2004      0      0     0      0      0     0           0 #>  9 Honduras  2005      0      0     0      0      0     0           0 #> 10 Honduras  2006      0      0     0      0      0     0           0 #> # … with 16 more rows"},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_intensity_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the relative intensity of influenza A circulation — get_country_intensity_data","title":"Get the relative intensity of influenza A circulation — get_country_intensity_data","text":"get_country_intensity data() returns data annual intensity influenza circulation calendar year. Following Gostic et al. Science, 2016, define 1 average intensity. Seasons intensities greater 1 flu circulation average, seasons intensities less 1 mild.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_intensity_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the relative intensity of influenza A circulation — get_country_intensity_data","text":"","code":"get_country_intensity_data(country, max_year, min_specimens = 50)"},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_intensity_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the relative intensity of influenza A circulation — get_country_intensity_data","text":"country country interest. Run show_available_countries() valid inputs. max_year last year interest. Results generated 1918:max_year. min_specimens fewer min_specimens (default 50) tested country year interest, function substitute data corresponding region.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_intensity_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the relative intensity of influenza A circulation — get_country_intensity_data","text":"tibble showing year intensity score.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_country_intensity_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get the relative intensity of influenza A circulation — get_country_intensity_data","text":"1918-1996, use annual intensities Gostic et al., Science, 2016. 1997-present, calculate country region-specific intensities using surveillance data Flu Mart. Intensity calculated : [fraction processed samples positive flu ]/[mean fraction processed samples positive flu ]. Country-specific data used default. Regional global data substituted country-specific data contain observations fail quality checks. Global data used years regional data insufficient.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_imprinting_probabilities.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate imprinting probabilities — get_imprinting_probabilities","title":"Calculate imprinting probabilities — get_imprinting_probabilities","text":"country year observation, calculate probability cohorts born year 1918 year observation imprinted specific influenza virus subtype (H1N1, H2N2, H3N2), group (group 1 contains H1N1 H2N2; group 2 contains H3N2).","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_imprinting_probabilities.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate imprinting probabilities — get_imprinting_probabilities","text":"","code":"get_imprinting_probabilities(   observation_years,   countries,   annual_frequencies = NULL,   df_format = \"long\" )"},{"path":"https://cobeylab.github.io/imprinting/reference/get_imprinting_probabilities.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate imprinting probabilities — get_imprinting_probabilities","text":"observation_years year(s) observation output imprinting probabilities. observation year, together birth year, determines birth cohort's age calculating imprinting probabilities. Cohorts <=12 years old time observation probability naive influenza. countries vector countries calculate imprinting probabilities. Run show_available_countries() list valid inputs, proper spellings. annual_frequencies optional input allowing users specify custom circulation frequencies arbitrary types imprinting order study, e.g. imprinting specific strains, clades, imprinting vaccination. nothing input, default calculate subtype-specific probabilities (possible imprinting types /H1N1, /H2N2, /H3N2, naive). See Details. df_format must either 'long' (default) 'wide'. Controls whether output data frame long format (single column calculated probabilities second column imprinting subtype), wide format (four columns, H1N1, H2N2, H3N2, naive) showing probability imprinting status.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_imprinting_probabilities.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate imprinting probabilities — get_imprinting_probabilities","text":"format=long (default), long tibble columns showing imprinting subtype (H1N1, H2N2, H3N2, naive), year observation, country, birth year, imprinting probability. format=wide, wide tibble row representing country, observation year, birth year, column influenza subtype (H1N1, H2N2, H3N2), probability someone born year remains naive influenza yet imprinted. cohorts >12 years old year observation, probability remaining naive 0, subtype-specific probabilities normalized sum 1. cohorts <=12 years old year observation, probability remaining naive non-zero. cohorts yet born time observation, output probabilities 0.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_imprinting_probabilities.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate imprinting probabilities — get_imprinting_probabilities","text":"Imprinting probabilities calculated following Gostic et al. 2016. Briefly, model first calculates probability individual's first influenza infection occurs 0, 1, 2, ... 12 years birth using modified geometric waiting time model. annual circulation intensities output get_country_intensity_data() scale probability primary infection calendar year. , calculating probability imprinting 0, 1, 2, ... calendar years birth, model uses data subtypes circulated calendar year (get_country_cocirculation_data()) estimate probability first infection caused subtype. See get_country_cocirculation_data() details underlying data sources. calculate kinds imprinting probabilities (e.g. specific clades, strains, include pediatric vaccination), users can specify custom circulation frequencies list, annual_frequencies. list must contain one named element country countries input vector. list element must data frame tibble whose first column named \"year\" contains numeric years 1918:max(observation_years). Columns 2:N data frame must contain circulation frequencies sum 1 across row, column must unique name indicating exposure kind. E.g. column names \"year\", \"H1N1\", \"H2N2\", \"H3N2\", \"vaccinated\" include probabilities imprinting vaccine, \"year\", \"3C.3A\", \"not_3C.3A\" calculate clade-specific probabilities.  include naive column. number imprinting types allowed, code optimized run efficiently number categories large. Frequencies within column must supplied user. See Vieira et al. 2021 methods estimate circulation frequencies sequence databases like GISAID NCBI Sequence Database. See vignette(\"custom-imprinting-types\") use custom annual_frequencies input.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_imprinting_probabilities.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate imprinting probabilities — get_imprinting_probabilities","text":"","code":"# =========================================================== # Get imprinting probabilities for one country and year get_imprinting_probabilities(2022, \"United States\") #> # A tibble: 420 × 5 #>     year country       birth_year subtype imprinting_prob #>    <dbl> <chr>              <dbl> <chr>             <dbl> #>  1  2022 United States       2022 A/H1N1        0.0000297 #>  2  2022 United States       2021 A/H1N1        0.0000679 #>  3  2022 United States       2020 A/H1N1        0.0702    #>  4  2022 United States       2019 A/H1N1        0.152     #>  5  2022 United States       2018 A/H1N1        0.171     #>  6  2022 United States       2017 A/H1N1        0.147     #>  7  2022 United States       2016 A/H1N1        0.225     #>  8  2022 United States       2015 A/H1N1        0.169     #>  9  2022 United States       2014 A/H1N1        0.308     #> 10  2022 United States       2013 A/H1N1        0.321     #> # … with 410 more rows # =========================================================== # Return the same outputs in wide format get_imprinting_probabilities(2022,   \"United States\",   df_format = \"wide\" ) #> # A tibble: 105 × 7 #>     year country       birth_year `A/H1N1` `A/H2N2` `A/H3N2` naive #>    <dbl> <chr>              <dbl>    <dbl>    <dbl>    <dbl> <dbl> #>  1  2022 United States       1918        1        0        0     0 #>  2  2022 United States       1919        1        0        0     0 #>  3  2022 United States       1920        1        0        0     0 #>  4  2022 United States       1921        1        0        0     0 #>  5  2022 United States       1922        1        0        0     0 #>  6  2022 United States       1923        1        0        0     0 #>  7  2022 United States       1924        1        0        0     0 #>  8  2022 United States       1925        1        0        0     0 #>  9  2022 United States       1926        1        0        0     0 #> 10  2022 United States       1927        1        0        0     0 #> # … with 95 more rows"},{"path":"https://cobeylab.github.io/imprinting/reference/get_p_infection_year.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the probability imprinting occurs n years after birth — get_p_infection_year","title":"Calculate the probability imprinting occurs n years after birth — get_p_infection_year","text":"Given individual's birth year, year observation, pre-calculated influenza circulation intensities, calculate probability first influenza infection occurs exactly 0, 1, 2, ... 12 years birth.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_p_infection_year.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the probability imprinting occurs n years after birth — get_p_infection_year","text":"","code":"get_p_infection_year(   birth_year,   observation_year,   intensity_df,   max_year,   baseline_annual_p_infection = 0.28 )"},{"path":"https://cobeylab.github.io/imprinting/reference/get_p_infection_year.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the probability imprinting occurs n years after birth — get_p_infection_year","text":"birth_year year birth (numeric). Must 1918 current calendar year. observation_year year observation, affects birth cohort's age. intensity_df data frame annual intensities, output get_country_intensity_data(). max_year maximum year output probabilities. Must greater equal observation_year. (doubt, set equal observation year.) baseline_annual_p_infection average annual probability primary infection. default, 0.28, estimated using age-seroprevalence data Gostic et al. 2016.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_p_infection_year.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the probability imprinting occurs n years after birth — get_p_infection_year","text":"vector whose entries show probability person born year 0 first infected influenza year 0, 1, 2, 3, ...12 consider first 13 probabilities (.e. assume everyone imprints age 13. outputs normalized, vector sum asymptotically approaches one, exactly equal one. cohorts born <13 years prior year observation, output vector less 13 entries.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_p_infection_year.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate the probability imprinting occurs n years after birth — get_p_infection_year","text":"probability primary influenza infection n years birth calculated based modified geometric distribution: let p average annual probability primary influenza infection. probability primary infection occurs n=0,1,2,... years birth \\(p*(1-p)^{n}\\). function modifies geometric model account changes annual circulation intensity, annual probabilities primary infection \\(p_i\\) scaled intensity calendar year . Details given Gostic et al. Science, 2016.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_p_infection_year.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the probability imprinting occurs n years after birth — get_p_infection_year","text":"","code":"# For a cohort under 12 years old and born in 2000, return the # probabilities of primary infection in 2000, 2001, ... 2012: get_p_infection_year(   birth_year = 2000,   observation_year = 2022,   intensity_df = get_country_intensity_data(\"Canada\", 2022),   max_year = 2022 ) #>  [1] 0.0024984455 0.0000000000 0.0000000000 0.0180147686 0.0000000000 #>  [6] 0.2742563000 0.0000000000 0.0008075884 0.0078780356 0.4875814033 #> [11] 0.0270627329 0.0665796926 0.0393163301  # If the cohort is still under age 12 at the time of observation, return # a truncated vector of probabilities: get_p_infection_year(   birth_year = 2020,   observation_year = 2022,   intensity_df = get_country_intensity_data(\"Mexico\", 2022),   max_year = 2022 ) #> [1] 0.10778376 0.04336504 0.30279601"},{"path":"https://cobeylab.github.io/imprinting/reference/get_regional_inputs_1997_to_present.html","id":null,"dir":"Reference","previous_headings":"","what":"Return raw flu surveillance data for a specific WHO region — get_regional_inputs_1997_to_present","title":"Return raw flu surveillance data for a specific WHO region — get_regional_inputs_1997_to_present","text":"Load return tibble containing raw influenza surveillance data, aggregated across countries region interest. Data Flu Mart.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_regional_inputs_1997_to_present.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return raw flu surveillance data for a specific WHO region — get_regional_inputs_1997_to_present","text":"","code":"get_regional_inputs_1997_to_present(region, max_year)"},{"path":"https://cobeylab.github.io/imprinting/reference/get_regional_inputs_1997_to_present.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return raw flu surveillance data for a specific WHO region — get_regional_inputs_1997_to_present","text":"region name region. Run show_available_regions() list options. max_year results output available years max_year.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_regional_inputs_1997_to_present.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return raw flu surveillance data for a specific WHO region — get_regional_inputs_1997_to_present","text":"tibble following columns: WHOREGION: name region. Year: calendar year . n_H1N1, n_H2N2, n_H3N2: number influenza specimens tested positive influenza subtype. n_A: total specimens positive influenza (= n_H1N1 + n_H2N2 + n_H3N2). n_BYam, n_BVic: number specimens positive lineage influenza B: Victoria Yamagata. n_B: total specimens positive influenza B. n_processed: total specimens processed.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_regional_inputs_1997_to_present.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return raw flu surveillance data for a specific WHO region — get_regional_inputs_1997_to_present","text":"","code":"get_regional_inputs_1997_to_present(\"americas\", 2017) #> # A tibble: 26 × 9 #>    WHOREGION            Year n_H1N1 n_H3N2   n_A n_BYam n_BVic   n_B n_processed #>    <chr>               <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>       <dbl> #>  1 Region of the Amer…  1997     16   1068  1084      0      0     0       21898 #>  2 Region of the Amer…  1998     19    670   689      0      0     0       43896 #>  3 Region of the Amer…  1999     93   5987  6080      0      0     0      138107 #>  4 Region of the Amer…  2000    862   1512  2374      0      0     0      119574 #>  5 Region of the Amer…  2001   1505   1125  2630      0      0     0      137455 #>  6 Region of the Amer…  2002    375   4364  4739      0      0     0      202359 #>  7 Region of the Amer…  2003   2565   7875 10440      0      0     0      279035 #>  8 Region of the Amer…  2004     88   3212  3300      0      0     0      180795 #>  9 Region of the Amer…  2005    202   7173  7375      0      0     0      231649 #> 10 Region of the Amer…  2006   1643   4241  5884      0      0     0      229234 #> # … with 16 more rows"},{"path":"https://cobeylab.github.io/imprinting/reference/get_template_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get country-independent flu circulation data for 1918-1996 — get_template_data","title":"Get country-independent flu circulation data for 1918-1996 — get_template_data","text":"get_template_data() returns tibble showing fraction influenza cases caused subtype H1N1, H2N2, H3N2 year 1918-1996. data country-independent. Country-specific data available 1997 . years 1918-1976 one influenza subtype circulated, fractions 0 1. 1977-1996 H1N1 H3N2 circulated. get_template_data() reports fraction influenza -positive specimens subtype observed US flu surveillance. See Thompson et al. JAMA, 2003, Table 1. Country-specific data Flu Mart appended template later steps.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/get_template_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get country-independent flu circulation data for 1918-1996 — get_template_data","text":"","code":"get_template_data()"},{"path":"https://cobeylab.github.io/imprinting/reference/get_template_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get country-independent flu circulation data for 1918-1996 — get_template_data","text":"tibble following columns: year /H1N1, /H2N2, /H3N2 show fraction influenza cases caused subtype. = /H1N1 + /H2N2 + /H3N2 B placeholder future calculate influenza B imprinting probabilities, currently contains NA. group1 group2 show fraction cases caused group 1 subtypes (H1N1 H2N2), group 2 (H3N2). data_from notes data source.","code":""},{"path":[]},{"path":"https://cobeylab.github.io/imprinting/reference/plot_many_country_years.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot imprinting probabilities for up to five country-years — plot_many_country_years","title":"Plot imprinting probabilities for up to five country-years — plot_many_country_years","text":"country year, generate two plots: stacked barplot, bar represents birth cohort, colors within bar show probabilities someone born cohort particular imprinting status, first observation year. lineplot showing age-specific probability imprinting H3N2 first last observation year. data contain one observation year, plot shows cohorts age time.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/plot_many_country_years.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot imprinting probabilities for up to five country-years — plot_many_country_years","text":"","code":"plot_many_country_years(imprinting_df)"},{"path":"https://cobeylab.github.io/imprinting/reference/plot_many_country_years.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot imprinting probabilities for up to five country-years — plot_many_country_years","text":"imprinting_df long data frame imprinted probabilities output get_imprinting_probabilities(). five countries arbitrary span years can plotted.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/plot_many_country_years.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot imprinting probabilities for up to five country-years — plot_many_country_years","text":"","code":"imprinting_df <- get_imprinting_probabilities(   observation_years = c(1920, 1921),   countries = c(\"Oman\", \"Indonesia\") ) plot_many_country_years(imprinting_df)"},{"path":"https://cobeylab.github.io/imprinting/reference/plot_one_country_year.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot imprinting probabilities for a single country and year — plot_one_country_year","title":"Plot imprinting probabilities for a single country and year — plot_one_country_year","text":"Generate stacked barplot, bar represents birth cohort, colors within bar show probabilities someone born cohort particular imprinting status. data frame contains one country observation year, first country-year plotted default. Specify countries years using country year options.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/plot_one_country_year.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot imprinting probabilities for a single country and year — plot_one_country_year","text":"","code":"plot_one_country_year(imprinting_df, country = NULL, year = NULL)"},{"path":"https://cobeylab.github.io/imprinting/reference/plot_one_country_year.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot imprinting probabilities for a single country and year — plot_one_country_year","text":"imprinting_df long data frame imprinted probabilities output get_imprinting_probabilities(). data frame contains one country year, first plotted. country optional country name plot. input country name must exist imprinting_df. year Similar country, optional input specifying year plot.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/plot_one_country_year.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot imprinting probabilities for a single country and year — plot_one_country_year","text":"","code":"# Generate imprinting probabilities for one country and year imprinting_df <- get_imprinting_probabilities(   observation_years = 1920,   countries = \"Aruba\" ) plot_one_country_year(imprinting_df)   # If we generate probabilities for more than one country and year, imprinting_df <- get_imprinting_probabilities(   observation_years = c(1922, 1925),   countries = c(     \"Algeria\",     \"South Africa\"   ) )  # The default is to plot the first country year in the outputs plot_one_country_year(imprinting_df)   # Or, specify a country and year of interest (both must exist in the # imprinting_df). plot_one_country_year(imprinting_df,   country = \"South Africa\",   year = 1925 )"},{"path":"https://cobeylab.github.io/imprinting/reference/show_available_countries.html","id":null,"dir":"Reference","previous_headings":"","what":"Show a list of all available countries — show_available_countries","title":"Show a list of all available countries — show_available_countries","text":"Lists available countries, valid spelling formatting. country list matches can mapped country data Flu Mart. (Note: convenience, package sometimes uses different country names spellings Flu Mart.)","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/show_available_countries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show a list of all available countries — show_available_countries","text":"","code":"show_available_countries()"},{"path":"https://cobeylab.github.io/imprinting/reference/show_available_countries.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show a list of all available countries — show_available_countries","text":"data frame valid country names.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/show_available_countries.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Show a list of all available countries — show_available_countries","text":"","code":"show_available_countries() #> # A tibble: 175 × 1 #>    country             #>    <chr>               #>  1 Afghanistan         #>  2 Albania             #>  3 Algeria             #>  4 Angola              #>  5 Anguilla            #>  6 Antigua and Barbuda #>  7 Argentina           #>  8 Armenia             #>  9 Aruba               #> 10 Australia           #> # … with 165 more rows"},{"path":"https://cobeylab.github.io/imprinting/reference/show_available_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Show all WHO regions — show_available_regions","title":"Show all WHO regions — show_available_regions","text":"Lists regions, valid spelling formatting.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/show_available_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show all WHO regions — show_available_regions","text":"","code":"show_available_regions()"},{"path":"https://cobeylab.github.io/imprinting/reference/show_available_regions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show all WHO regions — show_available_regions","text":"data frame valid region names.","code":""},{"path":"https://cobeylab.github.io/imprinting/reference/show_available_regions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Show all WHO regions — show_available_regions","text":"","code":"show_available_regions() #> # A tibble: 6 × 1 #>   region                #>   <chr>                 #> 1 eastern_mediterranean #> 2 europe                #> 3 africa                #> 4 americas              #> 5 western_pacific       #> 6 southeast_asia"}]
